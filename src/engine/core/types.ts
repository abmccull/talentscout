/**
 * Core type definitions for the TalentScout game engine.
 *
 * This module is the canonical source of truth for every domain type in the
 * game. All other engine modules import from here — no circular dependencies.
 *
 * Design notes:
 *  - Pure TypeScript: no React or runtime framework imports.
 *  - All IDs are strings (UUIDs generated by the world-builder at game start).
 *  - Player attributes use a 1–20 scale (Football Manager convention).
 *  - Player ability uses a 1–200 scale.
 *  - All types are plain data objects (no classes, no mutable state).
 */

// =============================================================================
// ATTRIBUTE SYSTEM
// =============================================================================

export type AttributeDomain =
  | "technical"
  | "physical"
  | "mental"
  | "tactical"
  | "hidden";

export type TechnicalAttribute =
  | "firstTouch"
  | "passing"
  | "dribbling"
  | "crossing"
  | "shooting"
  | "heading"
  | "tackling"
  | "finishing";

export type PhysicalAttribute =
  | "pace"
  | "strength"
  | "stamina"
  | "agility"
  | "jumping"
  | "balance";

export type MentalAttribute =
  | "composure"
  | "positioning"
  | "workRate"
  | "decisionMaking"
  | "leadership"
  | "anticipation";

export type TacticalAttribute =
  | "offTheBall"
  | "pressing"
  | "defensiveAwareness"
  | "vision"
  | "marking"
  | "teamwork";

/**
 * Hidden attributes are not directly observable during a match.
 * Scouts must infer them over many observations or via contact tips.
 */
export type HiddenAttribute =
  | "injuryProneness"
  | "consistency"
  | "bigGameTemperament"
  | "professionalism";

export type PlayerAttribute =
  | TechnicalAttribute
  | PhysicalAttribute
  | MentalAttribute
  | TacticalAttribute
  | HiddenAttribute;

/**
 * Maps every PlayerAttribute to its AttributeDomain.
 * Used by the perception engine to determine which scout skill applies
 * when generating an observation reading.
 */
export const ATTRIBUTE_DOMAINS: Record<PlayerAttribute, AttributeDomain> = {
  // Technical
  firstTouch: "technical",
  passing: "technical",
  dribbling: "technical",
  crossing: "technical",
  shooting: "technical",
  heading: "technical",
  tackling: "technical",
  finishing: "technical",

  // Physical
  pace: "physical",
  strength: "physical",
  stamina: "physical",
  agility: "physical",
  jumping: "physical",
  balance: "physical",

  // Mental
  composure: "mental",
  positioning: "mental",
  workRate: "mental",
  decisionMaking: "mental",
  leadership: "mental",
  anticipation: "mental",

  // Tactical
  offTheBall: "tactical",
  pressing: "tactical",
  defensiveAwareness: "tactical",
  vision: "tactical",
  marking: "tactical",
  teamwork: "tactical",

  // Hidden — inferred over time, not directly observable in-match
  injuryProneness: "hidden",
  consistency: "hidden",
  bigGameTemperament: "hidden",
  professionalism: "hidden",
} as const;

/** Ordered list of all technical attribute keys. Useful for iteration. */
export const TECHNICAL_ATTRIBUTES: readonly TechnicalAttribute[] = [
  "firstTouch",
  "passing",
  "dribbling",
  "crossing",
  "shooting",
  "heading",
  "tackling",
  "finishing",
] as const;

export const PHYSICAL_ATTRIBUTES: readonly PhysicalAttribute[] = [
  "pace",
  "strength",
  "stamina",
  "agility",
  "jumping",
  "balance",
] as const;

export const MENTAL_ATTRIBUTES: readonly MentalAttribute[] = [
  "composure",
  "positioning",
  "workRate",
  "decisionMaking",
  "leadership",
  "anticipation",
] as const;

export const TACTICAL_ATTRIBUTES: readonly TacticalAttribute[] = [
  "offTheBall",
  "pressing",
  "defensiveAwareness",
  "vision",
  "marking",
  "teamwork",
] as const;

export const HIDDEN_ATTRIBUTES: readonly HiddenAttribute[] = [
  "injuryProneness",
  "consistency",
  "bigGameTemperament",
  "professionalism",
] as const;

export const ALL_ATTRIBUTES: readonly PlayerAttribute[] = [
  ...TECHNICAL_ATTRIBUTES,
  ...PHYSICAL_ATTRIBUTES,
  ...MENTAL_ATTRIBUTES,
  ...TACTICAL_ATTRIBUTES,
  ...HIDDEN_ATTRIBUTES,
] as const;

// =============================================================================
// PERSONALITY TRAITS
// =============================================================================

/**
 * Personality traits describe the behavioural and psychological makeup of a
 * player. Each player has 2–4 true traits (hidden) and a separate set of
 * traits that have been revealed through scouting observations.
 *
 * Traits influence report quality but are never directly visible as numeric
 * attributes — they are qualitative descriptors discovered over time.
 */
export type PersonalityTrait =
  | "ambitious"
  | "loyal"
  | "professional"
  | "temperamental"
  | "determined"
  | "easygoing"
  | "leader"
  | "introvert"
  | "flair"
  | "controversialCharacter"
  | "modelCitizen"
  | "pressurePlayer"
  | "bigGamePlayer"
  | "inconsistent"
  | "injuryProne"
  | "lateDeveloper";

// =============================================================================
// PLAYER ROLES & BEHAVIORAL TRAITS
// =============================================================================

/**
 * Tactical roles define how a player behaves within a formation.
 * Each position has 2-4 compatible roles.
 */
export type PlayerRole =
  // GK
  | "shotStopper"
  | "sweeper"
  // CB
  | "ballPlayingDefender"
  | "noNonsenseCB"
  | "libero"
  // LB/RB
  | "fullBack"
  | "wingBack"
  | "invertedFullBack"
  // CDM
  | "anchorMan"
  | "halfBack"
  | "deepLyingPlaymaker"
  // CM
  | "boxToBox"
  | "mezzala"
  | "advancedPlaymaker"
  | "carrilero"
  // CAM
  | "enganche"
  | "shadowStriker"
  | "trequartista"
  // LW/RW
  | "winger"
  | "invertedWinger"
  | "insideForward"
  // ST
  | "poacher"
  | "targetMan"
  | "advancedForward"
  | "pressingForward";

export type RoleDuty = "defend" | "support" | "attack";

/**
 * Behavioral traits describe what a player does on the pitch.
 * Distinct from personality traits (who they are off the pitch).
 * Discovered through match observations.
 */
export type PlayerTrait =
  // Attacking (7)
  | "placesShots"
  | "triesTricks"
  | "cutsInside"
  | "runsWithBall"
  | "movesIntoChannels"
  | "shootsFromDistance"
  | "triesKillerBalls"
  // Defensive (3)
  | "staysBack"
  | "divesStraightIn"
  | "marksPlayerTightly"
  // Passing (4)
  | "dictatesTempo"
  | "playsShortPasses"
  | "switchesPlayToFlank"
  | "playsOneTwo"
  // Physical/Style (4)
  | "holdsUpBall"
  | "bringsOthersIntoPlay"
  | "arrivesLateInBox"
  | "playsWithBackToGoal"
  // Positional (2)
  | "driftsWide"
  | "dropsDeep";

// =============================================================================
// TACTICAL STYLE
// =============================================================================

/**
 * High-level tactical identity for a club. Drives tactical fit scoring
 * and determines which player attributes are most valued.
 */
export type TacticalIdentity =
  | "possessionBased"
  | "highPress"
  | "counterAttacking"
  | "directPlay"
  | "balanced"
  | "wingPlay";

/**
 * A club's tactical style, describing how they play.
 * Generated from scouting philosophy and club reputation.
 */
export interface TacticalStyle {
  /** 1-20: 1=deep block, 20=extreme high line. */
  defensiveLine: number;
  /** 1-20: 1=sit back, 20=gegenpressing. */
  pressingIntensity: number;
  /** 1-20: 1=slow patient, 20=fast direct. */
  tempo: number;
  /** 1-20: 1=narrow central, 20=very wide. */
  width: number;
  /** 1-20: 1=short passing, 20=long balls. */
  directness: number;
  tacticalIdentity: TacticalIdentity;
  /** Weight modifiers per event type — shifts event frequency during matches. */
  eventDistribution?: Partial<Record<MatchEventType, number>>;
  /** Tactical identities this style counters (rock-paper-scissors). */
  strengthAgainst?: TacticalIdentity[];
  /** Tactical identities this style is weak against. */
  weakAgainst?: TacticalIdentity[];
}

// =============================================================================
// PLAYER
// =============================================================================

export type Position =
  | "GK"
  | "CB"
  | "LB"
  | "RB"
  | "CDM"
  | "CM"
  | "CAM"
  | "LW"
  | "RW"
  | "ST";

export const ALL_POSITIONS: readonly Position[] = [
  "GK",
  "CB",
  "LB",
  "RB",
  "CDM",
  "CM",
  "CAM",
  "LW",
  "RW",
  "ST",
] as const;

export type Foot = "left" | "right" | "both";

/**
 * Development profiles define the shape of a player's growth curve.
 *  - earlyBloomer:  peaks early (~age 22), declines faster than peers
 *  - lateBloomer:   slow early growth, best years from ~age 28
 *  - steadyGrower:  linear progression, reliable and predictable
 *  - volatile:      high variance — can surge or plateau unexpectedly
 */
export type DevelopmentProfile =
  | "earlyBloomer"
  | "lateBloomer"
  | "steadyGrower"
  | "volatile";

/**
 * WonderkidTier is a hidden internal classification used by the world
 * generator to seed potential ability and club transfer interest levels.
 *  - generational: PA 180–200, once-in-a-generation players
 *  - worldClass:   PA 150–179, regular full internationals at elite clubs
 *  - qualityPro:   PA 100–149, solid professionals, top flight regulars
 *  - journeyman:   PA < 100, lower divisions and squad fillers
 */
export type WonderkidTier =
  | "generational"
  | "worldClass"
  | "qualityPro"
  | "journeyman";

export interface Player {
  id: string;
  firstName: string;
  lastName: string;
  age: number;
  dateOfBirth: { day: number; month: number; year: number };
  nationality: string;
  position: Position;
  secondaryPositions: Position[];
  preferredFoot: Foot;
  clubId: string;
  /** Season year in which the player's contract expires. */
  contractExpiry: number;
  /** Weekly wage in game currency. */
  wage: number;
  /** Estimated transfer market value. */
  marketValue: number;

  /**
   * True attribute values on a 1–20 scale.
   * These are never shown directly to the player (scout); they are revealed
   * only through scouting observations with appropriate confidence intervals.
   */
  attributes: Record<PlayerAttribute, number>;

  /** Derived composite ability score, 1–200, weighted by position. */
  currentAbility: number;
  /** Hard ceiling for future growth — the maximum CA the player can ever reach. */
  potentialAbility: number;
  developmentProfile: DevelopmentProfile;
  wonderkidTier: WonderkidTier;

  /** Short-term form modifier in [-3, 3]. Positive = hot streak. */
  form: number;
  /** Morale on 1–10 scale; affects performance and transfer willingness. */
  morale: number;
  injured: boolean;
  injuryWeeksRemaining: number;

  /** Current active injury (if any). */
  currentInjury?: Injury;
  /** Full injury history for this player. */
  injuryHistory?: InjuryHistory;

  /**
   * The player's true personality traits (2–4).
   * Hidden from the scout; revealed incrementally through observation.
   */
  personalityTraits: PersonalityTrait[];
  /**
   * Subset of personalityTraits that the scout has discovered so far.
   * Populated by the perception engine during observation sessions.
   */
  personalityRevealed: PersonalityTrait[];

  /** The player's best-fit tactical role, determined at generation. */
  naturalRole?: PlayerRole;
  /** A secondary role the player can competently fill. */
  secondaryRole?: PlayerRole;
  /** Behavioral traits describing what the player does on the pitch (2-4). */
  playerTraits: PlayerTrait[];
  /** Subset of playerTraits discovered through match observations. */
  playerTraitsRevealed: PlayerTrait[];

  /** Rolling window of last 6 match ratings, for form calculation. */
  recentMatchRatings: MatchFormEntry[];
  /** One consolidated entry per completed season — permanent history. */
  seasonRatings: SeasonRatingRecord[];

  /**
   * Full personality profile including archetype, transfer willingness,
   * dressing room impact, form volatility, and big-match modifier.
   * Generated at player creation; progressively revealed through scouting.
   */
  personalityProfile?: PersonalityProfile;

  /** Disciplinary record tracking cards and suspensions for the current season. */
  disciplinaryRecord?: DisciplinaryRecord;
}

// =============================================================================
// MATCH RATING SYSTEM
// =============================================================================

/** Per-player match rating with position-appropriate stat breakdown. */
export interface PlayerMatchRating {
  playerId: string;
  fixtureId: string;
  /** 1.0–10.0, one decimal place. */
  rating: number;
  eventCount: number;
  /** Position-relevant stats extracted from events. */
  stats: MatchPlayerStats;
  source: "attended" | "simulated";
}

/**
 * Position-relevant match statistics. All fields optional — only populated
 * when the player participated in relevant events.
 */
export interface MatchPlayerStats {
  // Attacking (all outfield)
  goals?: number;
  assists?: number;
  shots?: number;
  // Creative
  keyPasses?: number;
  crosses?: number;
  dribbles?: number;
  // Defensive
  tackles?: number;
  interceptions?: number;
  aerialDuelsWon?: number;
  // GK-specific
  saves?: number;
  goalsConceded?: number;
  cleanSheet?: boolean;
  // General
  errors?: number;
  // Aggregate quality
  avgEventQuality?: number;
}

/** Rolling form history entry — one per match. */
export interface MatchFormEntry {
  fixtureId: string;
  week: number;
  season: number;
  rating: number;
}

/** Consolidated season performance — stored permanently per player. */
export interface SeasonRatingRecord {
  season: number;
  avgRating: number;
  appearances: number;
  goals: number;
  assists: number;
  /** GK only (0 for outfield). */
  cleanSheets: number;
}

// =============================================================================
// CLUB & LEAGUE
// =============================================================================

/**
 * How a club approaches the transfer market and youth development.
 *  - academyFirst:    invest in youth, patient with youngsters
 *  - winNow:         high transfer spend, short-term thinking
 *  - marketSmart:    buy low / sell high, data-driven valuations
 *  - globalRecruiter: scours every continent, builds diverse squads
 */
export type ScoutingPhilosophy =
  | "academyFirst"
  | "winNow"
  | "marketSmart"
  | "globalRecruiter";

export interface Club {
  id: string;
  name: string;
  /** 3–5 character abbreviation, e.g. "MCI", "BARCA". */
  shortName: string;
  leagueId: string;
  /** Global prestige rating, 1–100. Higher = attracts better players. */
  reputation: number;
  /** Available transfer budget in game currency. */
  budget: number;
  scoutingPhilosophy: ScoutingPhilosophy;
  managerId: string;
  playerIds: string[];
  /** Quality of the youth intake system, 1–20. */
  youthAcademyRating: number;
  /** The club's tactical playing style. */
  tacticalStyle?: TacticalStyle;
}

export interface League {
  id: string;
  name: string;
  /** Short code, e.g. "EPL", "BL1", "LIGA". */
  shortName: string;
  country: string;
  /** 1 = top flight, 2 = second tier, etc. */
  tier: number;
  clubIds: string[];
  season: number;
}

export type Weather =
  | "clear"
  | "cloudy"
  | "rain"
  | "heavyRain"
  | "snow"
  | "windy";

export interface Fixture {
  id: string;
  homeClubId: string;
  awayClubId: string;
  leagueId: string;
  week: number;
  played: boolean;
  homeGoals?: number;
  awayGoals?: number;
  attendance?: number;
  weather?: Weather;
}

// =============================================================================
// SCOUT
// =============================================================================

/**
 * Primary specialization domains.
 *  - youth:      players under 21; better at reading potential over CA
 *  - firstTeam:  ready-now players; focus on current ability accuracy
 *  - regional:   deep knowledge of one geographic territory
 *  - data:       statistical analysis; unlocks data overlays on reports
 */
export type Specialization = "youth" | "firstTeam" | "regional" | "data";

/**
 * Scout skills — determine accuracy and depth of attribute assessments.
 *  - technicalEye:          reading technical attributes
 *  - physicalAssessment:    reading physical attributes
 *  - psychologicalRead:     reading mental and hidden attributes
 *  - tacticalUnderstanding: reading tactical attributes
 *  - dataLiteracy:          interpreting statistics (data specialization perk)
 */
export type ScoutSkill =
  | "technicalEye"
  | "physicalAssessment"
  | "psychologicalRead"
  | "tacticalUnderstanding"
  | "dataLiteracy"
  | "playerJudgment"
  | "potentialAssessment";

/**
 * Scout personal attributes that affect career mechanics.
 *  - networking:    unlocks contacts faster, improves contact quality
 *  - persuasion:    amplifies conviction level impact on club decisions
 *  - endurance:     reduces fatigue accumulation per activity
 *  - adaptability:  reduces accuracy penalty in unfamiliar regions
 *  - memory:        retains more detail from video analysis sessions
 *  - intuition:     chance of detecting hidden attributes without indicators
 */
export type ScoutAttribute =
  | "networking"
  | "persuasion"
  | "endurance"
  | "adaptability"
  | "memory"
  | "intuition";

/**
 * Career progression ladder.
 *  1 = Freelance scout (no club, self-employed)
 *  2 = Part-time regional scout
 *  3 = Full-time club scout
 *  4 = Head of scouting / chief scout
 *  5 = Director of football / sporting director
 */
export type CareerTier = 1 | 2 | 3 | 4 | 5;

export interface Scout {
  id: string;
  firstName: string;
  lastName: string;
  age: number;
  /** Scout's nationality (flavour / display field, not mechanically enforced). */
  nationality?: string;

  /** Scout skill ratings on 1–20 scale. */
  skills: Record<ScoutSkill, number>;
  /** Scout personal attribute ratings on 1–20 scale. */
  attributes: Record<ScoutAttribute, number>;

  primarySpecialization: Specialization;
  secondarySpecialization?: Specialization;
  /** Depth of mastery within the primary specialization, 1–20. */
  specializationLevel: number;
  /**
   * IDs of unlocked specialization perks.
   * Examples: "youthEye", "dataDriven", "setpieceReader", "mentorNetwork"
   */
  unlockedPerks: string[];

  careerTier: CareerTier;
  /** Whether the scout is on the club or independent career path. */
  careerPath: CareerPath;
  /** Independent path tier (only used when careerPath === "independent"). */
  independentTier?: IndependentTier;
  /** Global scouting reputation, 0–100. Determines job offer quality. */
  reputation: number;
  /** Trust level with current employer club, 0–100. Affects report weight. */
  clubTrust: number;
  /** Reputation within the scout's specialization community, 0–100. */
  specializationReputation: number;

  currentClubId?: string;
  contractEndSeason?: number;
  salary: number;
  savings: number;

  // Lifetime career statistics
  reportsSubmitted: number;
  successfulFinds: number;
  /** IDs of players the scout discovered before any other scout. */
  discoveryCredits: string[];

  /**
   * Fatigue level 0–100.
   * High fatigue reduces observation accuracy and report quality.
   * Recovered via rest activities or natural end-of-week recovery.
   */
  fatigue: number;

  /** Accumulated XP toward next skill level-up. Threshold = currentLevel * 10. */
  skillXp: Partial<Record<ScoutSkill, number>>;
  /** Accumulated XP toward next attribute level-up. Threshold = currentLevel * 10. */
  attributeXp: Partial<Record<ScoutAttribute, number>>;

  // --- Phase 1 extensions ---

  /** IDs of NPC scouts managed by the player (tier 4+). */
  npcScoutIds: string[];
  /** Per-country reputation tracking. */
  countryReputations: Record<string, CountryReputation>;
  /** Relationship with the current club's manager. */
  managerRelationship?: ManagerRelationship;
  /** Active board directives from the club hierarchy (tier 5). */
  boardDirectives: BoardDirective[];
  /** Current international travel booking (null if at home). */
  travelBooking?: TravelBooking;
}

// =============================================================================
// PERCEPTION & OBSERVATIONS
// =============================================================================

export type ObservationContext =
  | "liveMatch"
  | "videoAnalysis"
  | "trainingGround"
  | "youthTournament"
  | "academyVisit"
  | "schoolMatch"
  | "grassrootsTournament"
  | "streetFootball"
  | "academyTrialDay"
  | "youthFestival"
  | "followUpSession"
  | "parentCoachMeeting"
  // First-team exclusive contexts
  | "reserveMatch"
  | "oppositionAnalysis"
  | "agentShowcase"
  | "trialMatch"
  // Data-exclusive contexts
  | "databaseQuery"
  | "statsBriefing"
  | "deepVideoAnalysis";

export interface FlaggedMoment {
  /** Minute or phase index when this notable moment occurred. */
  phase: number;
  description: string;
  attribute: PlayerAttribute;
  positive: boolean;
}

/**
 * A single attribute reading within one observation session.
 * Perceived value and confidence are biased by scout skill, fatigue,
 * and contextual multipliers.
 */
export interface AttributeReading {
  attribute: PlayerAttribute;
  /** Scout's estimate on 1–20 scale (may differ from true value). */
  perceivedValue: number;
  /** Certainty in this reading, 0–1. */
  confidence: number;
  /** Number of separate sessions contributing to this reading. */
  observationCount: number;
  /** Lower bound of estimated range (1–20). Undefined in old saves. */
  rangeLow?: number;
  /** Upper bound of estimated range (1–20). Undefined in old saves. */
  rangeHigh?: number;
}

export interface Observation {
  id: string;
  playerId: string;
  scoutId: string;
  /** Set when context is liveMatch; references the Fixture id. */
  matchId?: string;
  week: number;
  season: number;
  context: ObservationContext;
  attributeReadings: AttributeReading[];
  /** Narrative notes generated by the perception engine. */
  notes: string[];
  flaggedMoments: FlaggedMoment[];
  abilityReading?: AbilityReading;
  /**
   * A personality trait uncovered during this observation session.
   * Set by the perception engine when the reveal roll succeeds.
   * Callers should add this to player.personalityRevealed in game state.
   */
  revealedPersonalityTrait?: PersonalityTrait;
  /**
   * A behavioral trait uncovered during this observation session.
   * Callers should add this to player.playerTraitsRevealed in game state.
   */
  revealedPlayerTrait?: PlayerTrait;
  /**
   * Role suitability inferences from this observation, if enough data exists.
   */
  inferredRoleFit?: Array<{ role: PlayerRole; suitability: number }>;
  /**
   * Updated personality profile after progressive reveal during this observation.
   * Callers should apply this to player.personalityProfile in game state.
   */
  updatedPersonalityProfile?: PersonalityProfile;
}

export interface AbilityReading {
  perceivedCA: number;       // 0.5-5.0 star rating
  caConfidence: number;      // 0-1
  perceivedPALow: number;   // PA range lower bound (0.5-5.0)
  perceivedPAHigh: number;  // PA range upper bound (0.5-5.0)
  paConfidence: number;     // 0-1
}

// =============================================================================
// REPORTS
// =============================================================================

/**
 * How strongly the scout recommends acquisition.
 *  - note:             "worth monitoring in future"
 *  - recommend:        "we should consider this player"
 *  - strongRecommend:  "sign this player soon"
 *  - tablePound:       "I stake my reputation — sign now"
 *                      (tablePounds are a limited career resource per season)
 */
export type ConvictionLevel =
  | "note"
  | "recommend"
  | "strongRecommend"
  | "tablePound";

export interface AttributeAssessment {
  attribute: PlayerAttribute;
  /** Scout's best point estimate of the true attribute value (1–20). */
  estimatedValue: number;
  /**
   * Confidence interval, e.g. [13, 16].
   * Narrower = higher accuracy. Width driven by observationCount and skill.
   */
  confidenceRange: [number, number];
  domain: AttributeDomain;
}

export interface ScoutReport {
  id: string;
  playerId: string;
  scoutId: string;
  submittedWeek: number;
  submittedSeason: number;

  attributeAssessments: AttributeAssessment[];
  strengths: string[];
  weaknesses: string[];
  conviction: ConvictionLevel;
  /** Free-text narrative written by the scout. */
  summary: string;
  /** ID of a known player the scout compares the subject to. */
  comparisonPlayerId?: string;
  estimatedValue: number;

  /**
   * Composite quality score 0–100.
   * Driven by scout skill, observation count, and confidence range widths.
   */
  qualityScore: number;

  /** Reputation change when this report was submitted. */
  reputationDelta?: number;

  /** Club's subsequent decision on the scouted player. */
  clubResponse?: "ignored" | "shortlisted" | "signed";
  /**
   * Retrospective accuracy rating set after a transfer completes, 0–100.
   * Compares report assessments to actual player attribute values.
   */
  postTransferRating?: number;

  /** Perceived current ability in half-star rating (0.5-5.0). */
  perceivedCAStars?: number;
  /** Perceived potential ability range in half-star ratings [low, high]. */
  perceivedPARange?: [number, number];

  /** System fit score for first-team scouts (0-100). */
  systemFitScore?: number;
  /** Statistical highlights for data scouts. */
  statisticalHighlights?: string[];
}

// =============================================================================
// CAREER
// =============================================================================

export interface JobOffer {
  id: string;
  clubId: string;
  tier: CareerTier;
  /** Human-readable role title, e.g. "Youth Scout", "Head of Scouting". */
  role: string;
  salary: number;
  /** Contract duration in seasons. */
  contractLength: number;
  /** Geographic territory assigned (relevant for regional roles). */
  territory?: string;
  /** Offer expires at end of this week; must accept/reject before then. */
  expiresWeek: number;
}

export interface PerformanceReview {
  season: number;
  reportsSubmitted: number;
  averageQuality: number;
  successfulRecommendations: number;
  tablePoundsUsed: number;
  tablePoundsSuccessful: number;
  reputationChange: number;
  outcome: "promoted" | "retained" | "warning" | "fired";
}

// =============================================================================
// NETWORK
// =============================================================================

export type ContactType =
  | "agent"
  | "scout"
  | "clubStaff"
  | "journalist"
  | "academyCoach"
  | "sportingDirector"
  | "grassrootsOrganizer"
  | "schoolCoach"
  | "youthAgent"
  | "academyDirector"
  | "localScout";

export interface Contact {
  id: string;
  name: string;
  type: ContactType;
  organization: string;
  /** Quality of relationship, 0–100. Higher = more willing to share info. */
  relationship: number;
  /**
   * How reliable the contact's tips are, 0–100.
   * Hidden from player initially; revealed through repeated interactions.
   */
  reliability: number;
  /** IDs of players this contact has information about. */
  knownPlayerIds: string[];
  /** Geographic region of expertise. */
  region?: string;
  /**
   * The country this contact primarily operates in.
   * Used for youth scouting intel and contact introductions.
   */
  country?: string;
  /**
   * The game week of the last interaction with this contact.
   * Used to calculate relationship decay over time.
   */
  lastInteractionWeek?: number;

  // --- F3: Contact Network Depth ---

  /** Trust level 0-100. Determines what information the contact will share. */
  trustLevel?: number;
  /** Hidden loyalty stat 0-100. Affects betrayal risk and gossip reliability. */
  loyalty?: number;
  /** History of interactions for trust/loyalty calculations. */
  interactionHistory?: ContactInteraction[];
  /** Pending gossip items this contact has to share. */
  gossipQueue?: GossipItem[];
  /** IDs of contacts this contact can introduce (referral network). */
  referralNetwork?: string[];
  /** Probability 0-1 that this contact will betray the scout. */
  betrayalRisk?: number;
  /** Timed exclusive access to a prospect via a high-trust insider. */
  exclusiveWindow?: {
    playerId: string;
    expiresWeek: number;
  };
}

// =============================================================================
// CONTACT INTEL
// =============================================================================

/**
 * A piece of hidden intelligence shared by a contact about a player.
 * Keyed by playerId in the `contactIntel` GameState record.
 */
export interface HiddenIntel {
  playerId: string;
  attribute: HiddenAttribute;
  /** Human-readable hint — worded as a scout's note, not a raw number. */
  hint: string;
  /**
   * 0–1: how reliable this intel is.
   * Determined by the contact's own reliability stat, not shown directly.
   */
  reliability: number;
}

// =============================================================================
// CALENDAR / SCHEDULE
// =============================================================================

export type ActivityType =
  | "attendMatch"
  | "watchVideo"
  | "writeReport"
  | "networkMeeting"
  | "trainingVisit"
  | "travel"
  | "study"
  | "rest"
  | "academyVisit"
  | "youthTournament"
  | "reviewNPCReport"
  | "managerMeeting"
  | "boardPresentation"
  | "assignTerritory"
  | "internationalTravel"
  | "schoolMatch"
  | "grassrootsTournament"
  | "streetFootball"
  | "academyTrialDay"
  | "youthFestival"
  | "followUpSession"
  | "parentCoachMeeting"
  | "writePlacementReport"
  // First-team exclusive activities
  | "reserveMatch"
  | "scoutingMission"
  | "oppositionAnalysis"
  | "agentShowcase"
  | "trialMatch"
  | "contractNegotiation"
  // Data-exclusive activities
  | "databaseQuery"
  | "deepVideoAnalysis"
  | "statsBriefing"
  | "dataConference"
  | "algorithmCalibration"
  | "marketInefficiency"
  | "analyticsTeamMeeting";

export interface Activity {
  /**
   * Unique schedule instance identifier.
   * Multi-slot activities share the same instanceId across occupied slots.
   */
  instanceId?: string;
  type: ActivityType;
  /** Time cost in day-slots (1 slot = 1 day; 7 slots per week Mon–Sun). */
  slots: number;
  /** ID of the target entity: match, player, contact, etc. */
  targetId?: string;
  description: string;
}

export interface WeekSchedule {
  week: number;
  season: number;
  /**
   * 7 slots representing Monday through Sunday.
   * null = the slot is free / unscheduled.
   */
  activities: (Activity | null)[];
  completed: boolean;
}

// =============================================================================
// MATCH ENGINE
// =============================================================================

export type MatchPhaseType =
  | "buildUp"
  | "transition"
  | "setpiece"
  | "pressingSequence"
  | "counterAttack"
  | "possession";

export type MatchEventType =
  | "goal"
  | "assist"
  | "shot"
  | "pass"
  | "dribble"
  | "tackle"
  | "header"
  | "save"
  | "foul"
  | "cross"
  | "sprint"
  | "positioning"
  | "error"
  | "leadership"
  | "aerialDuel"
  | "interception"
  | "throughBall"
  | "holdUp"
  | "injury"
  | "substitution"
  | "card";

export interface MatchEvent {
  minute: number;
  description: string;
  playerId: string;
  type: MatchEventType;
  /** Subjective quality of the action, 1–10. */
  quality: number;
  /** Which player attributes were made observable by this event. */
  attributesRevealed: PlayerAttribute[];
}

export type SetPieceVariant = "corner" | "freeKick" | "penalty" | "throwIn";

export interface MatchPhase {
  minute: number;
  type: MatchPhaseType;
  description: string;
  involvedPlayerIds: string[];
  events: MatchEvent[];
  /** Attributes that are generally observable during this phase type. */
  observableAttributes: PlayerAttribute[];
  /** Momentum value 0–100 computed from recent event quality. */
  momentum?: number;
  /** For setpiece phases, the specific variant. */
  setPieceVariant?: SetPieceVariant;
}

// =============================================================================
// INBOX
// =============================================================================

export type InboxMessageType =
  | "assignment"
  | "feedback"
  | "news"
  | "jobOffer"
  | "event"
  | "directive"
  | "clubResponse"
  | "transferUpdate"
  | "analystReport"
  | "predictionResult"
  | "warning";

export type InboxRelatedEntity = "player" | "report" | "contact" | "jobOffer" | "tool" | "narrative" | "directive" | "transfer" | "prediction" | "analyst";

export interface InboxMessage {
  id: string;
  week: number;
  season: number;
  type: InboxMessageType;
  title: string;
  body: string;
  read: boolean;
  actionRequired: boolean;
  /** ID of the related entity: player, report, job offer, etc. */
  relatedId?: string;
  /** What kind of entity relatedId points to, enabling action buttons. */
  relatedEntityType?: InboxRelatedEntity;
}

// =============================================================================
// STORYLINES (forward declaration to avoid circular import)
// =============================================================================

/**
 * A multi-week narrative storyline instance.
 * Defined in full in engine/events/storylines.ts — this minimal interface
 * is embedded here so GameState can reference it without a circular dep.
 */
export interface StorylineState {
  id: string;
  templateId: string;
  name: string;
  /** Opaque stage array — typed as unknown[] to avoid pulling in engine deps. */
  stages: unknown[];
  currentStage: number;
  nextStageWeek: number;
  nextStageSeason: number;
  startedWeek: number;
  startedSeason: number;
  resolved: boolean;
  context: Record<string, unknown>;
}

// =============================================================================
// GAME STATE
// =============================================================================

export interface GameState {
  /** The world seed used for deterministic world generation. */
  seed: string;
  /** Current week within the season, typically 1–38. */
  currentWeek: number;
  /** Current season year, e.g. 2024. */
  currentSeason: number;

  scout: Scout;

  // World data keyed by entity ID
  leagues: Record<string, League>;
  clubs: Record<string, Club>;
  players: Record<string, Player>;
  fixtures: Record<string, Fixture>;

  // Scout's personal working data keyed by entity ID
  observations: Record<string, Observation>;
  reports: Record<string, ScoutReport>;
  contacts: Record<string, Contact>;

  /** The active week schedule. Replaced each time the week advances. */
  schedule: WeekSchedule;

  jobOffers: JobOffer[];
  performanceReviews: PerformanceReview[];

  inbox: InboxMessage[];

  // --- Phase 1 extensions ---

  /** NPC scouts managed by the player, keyed by ID. */
  npcScouts: Record<string, NPCScout>;
  /** Reports generated by NPC scouts, keyed by ID. */
  npcReports: Record<string, NPCScoutReport>;
  /** Scouting territories assigned to NPC scouts, keyed by ID. */
  territories: Record<string, Territory>;
  /** Countries active in the game world. */
  countries: string[];

  // --- Phase 2 extensions (stubbed for forward-compatibility) ---

  /** Financial tracking — income, expenses, equipment. */
  finances?: FinancialRecord;
  /** Narrative events that have occurred. */
  narrativeEvents: NarrativeEvent[];
  /** Active multi-week storylines. */
  activeStorylines: StorylineState[];
  /** Rival scouts competing with the player. */
  rivalScouts: Record<string, RivalScout>;
  /** Tools unlocked by the player. */
  unlockedTools: ToolId[];
  /** Manager profiles per club (manager scouting preferences). */
  managerProfiles: Record<string, ManagerProfile>;

  // --- Phase 3 extensions (stubbed) ---

  /** Current transfer window state. */
  transferWindow?: TransferWindowState;
  /** Pre-defined season calendar events. */
  seasonEvents: SeasonEvent[];
  /** Daily schedule (used during transfer windows). */
  dailySchedule?: DaySchedule;

  // --- Phase 4 extensions (stubbed) ---

  /** The ID of the active scenario, if any. Null/undefined for freeplay. */
  activeScenarioId?: string;

  /** Records of player discoveries and their career trajectories. */
  discoveryRecords: DiscoveryRecord[];
  /** Historical performance snapshots for analytics. */
  performanceHistory: ScoutPerformanceSnapshot[];

  /**
   * Fixture IDs that the player has completed interactively via the MatchScreen.
   * Used by advanceWeek() to ensure the player scouts scheduled attendMatch
   * fixtures before the engine auto-simulates the week.
   */
  playedFixtures: string[];

  /** Player IDs bookmarked by the scout for quick access. */
  watchlist: string[];

  /** Hidden intel gathered from contacts, keyed by playerId. */
  contactIntel: Record<string, HiddenIntel[]>;

  // --- Youth Scouting System ---

  /** Unsigned youth players in the world, keyed by ID. */
  unsignedYouth: Record<string, UnsignedYouth>;
  /** Placement reports for unsigned youth, keyed by ID. */
  placementReports: Record<string, PlacementReport>;
  /** Gut feelings accumulated by the scout. */
  gutFeelings: GutFeeling[];
  /** Alumni records for placed youth. */
  alumniRecords: AlumniRecord[];
  /** Legacy score tracking placed youth career impact. */
  legacyScore: LegacyScore;
  /** Sub-regions for youth scouting depth, keyed by ID. */
  subRegions: Record<string, SubRegion>;
  /** IDs of players who have retired. */
  retiredPlayerIds: string[];

  // --- First-Team Scouting System ---

  /** Active manager directives for the scout's club. */
  managerDirectives: ManagerDirective[];
  /** Club responses to submitted reports. */
  clubResponses: ClubResponse[];
  /** Transfer records tracking signed players' performance. */
  transferRecords: TransferRecord[];
  /** Cached system fit results, keyed by "playerId:clubId". */
  systemFitCache: Record<string, SystemFitResult>;

  // --- Data Scouting System ---

  /** Data scout predictions tracking. */
  predictions: Prediction[];
  /** Data analysts employed by the scout. */
  dataAnalysts: DataAnalyst[];
  /** Statistical profiles generated by data analysis, keyed by playerId. */
  statisticalProfiles: Record<string, StatisticalProfile>;
  /** Active anomaly flags from data analysis. */
  anomalyFlags: AnomalyFlag[];
  /** Passive reports generated by data analysts, keyed by ID. */
  analystReports: Record<string, AnalystReport>;

  // --- Regional Scouting Depth (F13) ---

  /** Regional knowledge records per country, keyed by country key. */
  regionalKnowledge: Record<string, RegionalKnowledge>;

  // --- Match Rating System ---

  /**
   * Per-fixture, per-player match ratings. Keyed fixtureId → playerId.
   * Ephemeral — wiped at season end after consolidation into player.seasonRatings.
   */
  matchRatings: Record<string, Record<string, PlayerMatchRating>>;

  // --- Discipline/Card System ---

  /** Per-player disciplinary records, keyed by playerId. */
  disciplinaryRecords: Record<string, DisciplinaryRecord>;

  /** Unix timestamp (ms) when this game save was created. */
  createdAt: number;
  /** Unix timestamp (ms) of the most recent save. */
  lastSaved: number;
  /** Total weeks played across all sessions for this save. */
  totalWeeksPlayed: number;

  // --- Financial Strategy Layer (F14) ---

  /** Scouting infrastructure investment state. */
  scoutingInfrastructure?: ScoutingInfrastructure;
  /** Assistant scouts hired by the player. */
  assistantScouts?: AssistantScout[];

  // --- Event Chains (F2) ---

  /** Active and completed narrative event chains. */
  eventChains: EventChain[];

  // --- Transfer Negotiation System (F4) ---

  /** Active transfer negotiations the scout's club is involved in. */
  activeNegotiations: TransferNegotiation[];

  // --- Rival Scout Activities (F8) ---

  /** Log of rival scout activities for display and history tracking. */
  rivalActivities: RivalActivity[];

  // --- Dynamic Board Expectations (F10) ---

  /** Board of directors profile — personality, satisfaction, patience. */
  boardProfile?: BoardProfile;
  /** History of board reactions (praise, warnings, budget changes, ultimatums). */
  boardReactions: BoardReaction[];
}

// =============================================================================
// NEW GAME CONFIG
// =============================================================================

export interface NewGameConfig {
  scoutFirstName: string;
  scoutLastName: string;
  scoutAge: number;
  specialization: Specialization;
  difficulty: "easy" | "normal" | "hard";
  worldSeed: string;
  /** Starting region for regional specialists. Optional for other specs. */
  region?: string;
  /** Countries to include in the game world. Defaults to ["england"]. */
  selectedCountries?: string[];
  /** Starting country for the scout. Defaults to first selected country. */
  startingCountry?: string;
  /** Scout's nationality (display/flavour field). */
  nationality?: string;
  /**
   * If set, the scout begins employed at this club (tier 2 club scout).
   * If omitted, the scout starts as a freelancer (tier 1).
   */
  startingClubId?: string;
  /** Player-allocated bonus skill points during scout creation. */
  skillAllocations?: Partial<Record<ScoutSkill, number>>;
}

// =============================================================================
// MATCH FOCUS
// =============================================================================

/**
 * A scout's focus selection for a specific player during a live match.
 * The lens determines which attribute domain the scout concentrates on.
 */
export interface FocusSelection {
  playerId: string;
  /** Phase indices (0-based) during which this player was actively focused. */
  phases: number[];
  /** The observational lens applied — narrows which attributes are revealed. */
  lens: "technical" | "physical" | "mental" | "tactical" | "general";
}

// =============================================================================
// UTILITY TYPES
// =============================================================================

/**
 * Partial map of attribute changes. undefined means "no change" for that key.
 * Used in development tick results and attribute delta calculations.
 */
export type AttributeDeltas = Partial<Record<PlayerAttribute, number>>;

/** A single club's row in a league standings table. */
export interface StandingEntry {
  clubId: string;
  played: number;
  won: number;
  drawn: number;
  lost: number;
  goalsFor: number;
  goalsAgainst: number;
  goalDifference: number;
  points: number;
}

// =============================================================================
// PHASE 1: NPC SCOUTS & TERRITORIES
// =============================================================================

/**
 * An NPC scout that the player manages at career tier 4+.
 * NPC scouts autonomously scout territories and generate reports.
 */
export interface NPCScout {
  id: string;
  firstName: string;
  lastName: string;
  /** NPC quality tier, 1–5. Higher = better reports. */
  quality: number;
  /** Which country/region this NPC is assigned to. */
  territoryId?: string;
  /** Specialization the NPC focuses on. */
  specialization: Specialization;
  /** Weekly salary cost. */
  salary: number;
  /** Fatigue 0–100. High fatigue degrades report quality. */
  fatigue: number;
  /** Number of reports submitted this season. */
  reportsSubmitted: number;
  /** Morale 1–10. Low morale → less productive. */
  morale: number;
}

/**
 * A report generated by an NPC scout. Simplified compared to player reports.
 */
export interface NPCScoutReport {
  id: string;
  npcScoutId: string;
  playerId: string;
  week: number;
  season: number;
  /** Quality of the report, 0–100. Driven by NPC quality and fatigue. */
  quality: number;
  /** Brief text summary of the player. */
  summary: string;
  /** NPC's recommendation level. */
  recommendation: "monitor" | "shortlist" | "pursue";
  /** Whether the player has reviewed this report. */
  reviewed: boolean;
}

/**
 * A scouting territory that can be assigned to NPC scouts.
 */
export interface Territory {
  id: string;
  name: string;
  country: string;
  /** League IDs accessible from this territory. */
  leagueIds: string[];
  /** How many NPC scouts can be assigned here simultaneously. */
  maxScouts: number;
  /** IDs of NPC scouts currently assigned. */
  assignedScoutIds: string[];
}

/**
 * A scouting directive from the manager — what the club wants scouted.
 */
export interface ScoutingDirective {
  id: string;
  /** What the manager is looking for. */
  type: ScoutingPriority;
  /** Position the club needs. */
  position?: Position;
  /** Age range preference. */
  ageRange?: [number, number];
  /** Budget ceiling for the target. */
  maxBudget?: number;
  /** Urgency level 1–5. Higher = more impactful on review. */
  urgency: number;
  /** Description of what the manager wants. */
  description: string;
  /** Week this directive was issued. */
  issuedWeek: number;
  /** Whether the scout has addressed this directive. */
  fulfilled: boolean;
}

export type ScoutingPriority =
  | "firstTeamReady"
  | "youthProspect"
  | "specificPosition"
  | "loanTarget"
  | "budgetOption"
  | "worldClass";

/**
 * The player's relationship with the club manager.
 */
export interface ManagerRelationship {
  /** Manager's name. */
  managerName: string;
  /** Relationship quality 0–100. */
  trust: number;
  /** How often the manager listens to recommendations. */
  influence: number;
  /** Manager's preferred scouting style. */
  scoutingPreference: ScoutingPreference;
  /** Meetings held this season. */
  meetingsThisSeason: number;
}

export type ScoutingPreference =
  | "dataFirst"
  | "eyeTest"
  | "balanced"
  | "resultsBased";

/**
 * A board-level directive for the scouting department (tier 5).
 */
export interface BoardDirective {
  id: string;
  /** What the board wants to achieve. */
  type: "expandTerritory" | "cutCosts" | "findWonderkid" | "buildPipeline" | "improveAccuracy";
  description: string;
  /** Season deadline. */
  deadline: number;
  /** Whether the directive has been completed. */
  completed: boolean;
  /** Reputation reward on completion. */
  rewardReputation: number;
  /** Reputation penalty on failure. */
  penaltyReputation: number;
}

/**
 * An active travel booking for international scouting.
 */
export interface TravelBooking {
  /** Destination country. */
  destinationCountry: string;
  /** Week the travel departs. */
  departureWeek: number;
  /** Week the scout returns. */
  returnWeek: number;
  /** Cost in game currency. */
  cost: number;
  /** Whether the scout is currently abroad. */
  isAbroad: boolean;
}

/**
 * Scout's reputation and familiarity with a specific country.
 */
export interface CountryReputation {
  country: string;
  /** Familiarity 0–100. Higher = better accuracy in this country. */
  familiarity: number;
  /** Number of reports submitted from this country. */
  reportsSubmitted: number;
  /** Number of successful finds from this country. */
  successfulFinds: number;
  /** Contacts established in this country. */
  contactCount: number;
}

// =============================================================================
// ECONOMICS REVAMP — CAREER PATHS & FINANCIAL SYSTEMS
// =============================================================================

export type CareerPath = "club" | "independent";
export type IndependentTier = 1 | 2 | 3 | 4 | 5;
export type MarketTemperature = "hot" | "normal" | "cold" | "deadline";

export type ReportListingStatus = "active" | "sold" | "withdrawn" | "expired";

export interface ReportListing {
  id: string;
  reportId: string;
  price: number;
  isExclusive: boolean;
  targetClubId?: string;
  status: ReportListingStatus;
  buyerClubId?: string;
  listedWeek: number;
  listedSeason: number;
}

export interface PlacementFeeRecord {
  id: string;
  playerId: string;
  clubId: string;
  transferFee: number;
  earnedFee: number;
  hasSellOnClause: boolean;
  sellOnPercentage: number;
  week: number;
  season: number;
}

export type RetainerStatus = "active" | "suspended" | "cancelled";

export interface RetainerContract {
  id: string;
  clubId: string;
  tier: 1 | 2 | 3 | 4 | 5;
  monthlyFee: number;
  requiredReportsPerMonth: number;
  reportsDeliveredThisMonth: number;
  status: RetainerStatus;
}

export type AgencyEmployeeRole = "scout" | "analyst" | "administrator" | "relationshipManager" | "mentee";

// --- Employee Skill System ---

export type ScoutEmployeeSkill = "coverage" | "accuracy" | "potential";
export type AnalystSkill = "insightDepth" | "patternRecognition" | "efficiency";
export type AdministratorSkill = "costControl" | "organization" | "paperwork";
export type RelationshipManagerSkill = "prospecting" | "clientRetention" | "negotiation";

export type EmployeeSkillName =
  | ScoutEmployeeSkill
  | AnalystSkill
  | AdministratorSkill
  | RelationshipManagerSkill;

export interface EmployeeSkills {
  skill1: number; // 1-20 scale
  skill2: number;
  skill3: number;
  xp1: number;
  xp2: number;
  xp3: number;
}

export interface EmployeeTraining {
  skillIndex: 1 | 2 | 3;
  skillName: string;
  weeksRemaining: number;
  cost: number;
}

export interface AgencyEmployee {
  id: string;
  name: string;
  role: AgencyEmployeeRole;
  quality: number;
  salary: number;
  morale: number;
  fatigue: number;
  // --- Phase 2 fields ---
  hiredWeek: number;
  hiredSeason: number;
  regionSpecialization?: string;
  positionSpecialization?: string;
  reportsGenerated: string[];
  currentAssignment?: EmployeeAssignment;
  experience: number;
  weeklyLog: EmployeeLogEntry[];
  // --- Phase 4 fields ---
  regionFocusWeeks: number;
  onLeave?: boolean;
  leaveReturnWeek?: number;
  // --- Phase 5 fields ---
  skills?: EmployeeSkills;
  activeTraining?: EmployeeTraining;
}

export interface EmployeeAssignment {
  type: "scoutRegion" | "scoutPlayer" | "analyzeReports" | "manageClients" | "adminDuties" | "idle";
  targetRegion?: string;
  targetPlayerId?: string;
  targetClubId?: string;
  assignedWeek: number;
  assignedSeason: number;
}

export interface EmployeeLogEntry {
  week: number;
  season: number;
  action: string;
  result?: string;
  reportId?: string;
}

export interface EmployeeEvent {
  id: string;
  type: "poaching" | "trainingRequest" | "personalIssue" | "breakthrough";
  employeeId: string;
  description: string;
  options: EmployeeEventOption[];
  deadline: number;
  deadlineSeason: number;
}

export interface EmployeeEventOption {
  label: string;
  cost?: number;
  moraleChange: number;
  effect: "matchSalary" | "grantLeave" | "denyLeave" | "fundTraining" | "declineTraining" | "acceptPoach" | "ignore";
}

export interface ClientRelationship {
  clubId: string;
  satisfaction: number;
  totalReportsDelivered: number;
  totalRevenue: number;
  tenureWeeks: number;
  preferences: ClientPreference[];
  status: "prospect" | "active" | "cooling" | "lost";
  lastInteractionWeek: number;
  lastInteractionSeason: number;
}

export type ClientPreference = "youth" | "firstTeam" | "data" | "physical" | "technical" | "specificPosition";

export interface PitchResult {
  success: boolean;
  message: string;
  offeredContract?: RetainerContract;
}

export interface SatelliteOffice {
  id: string;
  region: string;
  monthlyCost: number;
  qualityBonus: number;
  maxEmployees: number;
  employeeIds: string[];
  openedWeek: number;
  openedSeason: number;
}

export interface AwardRecord {
  season: number;
  type: "scoutOfYear" | "bestAgency" | "discoveryOfYear";
  title: string;
  reputationBonus: number;
  cashBonus: number;
}

export interface ConsultingDeliverable {
  type: "reports" | "analysis" | "presentation";
  description: string;
  required: number;
  delivered: number;
}

export type OfficeTier = "home" | "coworking" | "small" | "professional" | "hq";

export interface Office {
  tier: OfficeTier;
  monthlyCost: number;
  qualityBonus: number;
  maxEmployees: number;
}

export interface CourseEffect {
  type: "skillBonus" | "attributeBonus" | "perkUnlock" | "tierGate" | "reputationBonus";
  target?: string;
  value: number;
}

export interface Course {
  id: string;
  name: string;
  description: string;
  cost: number;
  durationWeeks: number;
  prerequisites: string[];
  minTier: CareerTier;
  effects: CourseEffect[];
  category: "coaching" | "scouting" | "business" | "specialization";
}

export interface CourseEnrollment {
  courseId: string;
  startWeek: number;
  startSeason: number;
  completionWeek: number;
  completionSeason: number;
}

export type LifestyleLevel = 1 | 2 | 3 | 4 | 5;

export interface LifestyleConfig {
  level: LifestyleLevel;
  monthlyCost: number;
  networkingBonus: number;
  salaryOfferBonus: number;
}

export type LoanType = "business" | "equipment" | "emergency";

export interface Loan {
  id: string;
  type: LoanType;
  principal: number;
  monthlyInterestRate: number;
  remainingBalance: number;
  monthlyPayment: number;
  startWeek: number;
  startSeason: number;
}

export type ConsultingType = "transferAdvisory" | "youthAudit" | "dataPackage" | "talentWorkshop";
export type ConsultingStatus = "active" | "completed" | "failed" | "expired";

export interface ConsultingContract {
  id: string;
  clubId: string;
  type: ConsultingType;
  fee: number;
  deadline: number;
  deadlineSeason: number;
  status: ConsultingStatus;
  deliverables?: ConsultingDeliverable[];
}

export type EconomicEventType = "marketCrash" | "tvDealBonanza" | "ffpInvestigation" | "newOwnership" | "wageCap";

export interface EconomicEvent {
  id: string;
  type: EconomicEventType;
  description: string;
  multiplier: number;
  startWeek: number;
  startSeason: number;
  durationWeeks: number;
}

// =============================================================================
// PHASE 2: SYSTEMS DEPTH
// =============================================================================

export type NarrativeEventType =
  // Original 8
  | "rivalPoach"
  | "managerFired"
  | "exclusiveTip"
  | "debutHatTrick"
  | "targetInjured"
  | "reportCitedInBoardMeeting"
  | "rivalRecruitment"
  | "agentDeception"
  // Scout Personal Life (6)
  | "burnout"
  | "familyEmergency"
  | "scoutingConference"
  | "mentorOffer"
  | "mediaInterview"
  | "healthScare"
  // Club Drama (6)
  | "boardroomCoup"
  | "budgetCut"
  | "scoutingDeptRestructure"
  | "rivalClubPoach"
  | "managerSacked"
  | "clubFinancialTrouble"
  // Player Stories (8)
  | "wonderkidPressure"
  | "playerHomesick"
  | "hiddenGemVindication"
  | "playerControversy"
  | "youthProdigyDilemma"
  | "injurySetback"
  | "debutBrilliance"
  | "lateBloomingSurprise"
  // Network Events (6)
  | "contactBetrayal"
  | "exclusiveAccess"
  | "agentDoubleDealing"
  | "journalistExpose"
  | "networkExpansion"
  | "contactRetirement"
  // Industry Events (6)
  | "transferRuleChange"
  | "dataRevolution"
  | "youthAcademyScandal"
  | "internationalTournament"
  | "scoutingAwardNomination"
  | "financialFairPlayImpact";

export interface NarrativeEvent {
  id: string;
  type: NarrativeEventType;
  week: number;
  season: number;
  title: string;
  description: string;
  /** IDs of related entities (players, clubs, contacts). */
  relatedIds: string[];
  /** Whether this event has been acknowledged by the player. */
  acknowledged: boolean;
  /** Optional choices the player can make in response. */
  choices?: { label: string; effect: string }[];
  /** Index of the choice the player selected (undefined = no choice made). */
  selectedChoice?: number;

  // --- Event Chain fields (F2) ---

  /** Links events that belong to the same narrative chain. */
  chainId?: string;
  /** 1-based position within the chain (1, 2, 3...). */
  chainStep?: number;
  /** ID of the event that triggered this chain continuation. */
  parentEventId?: string;
  /** Absolute week when the follow-up event should fire. */
  followUpWeek?: number;
  /** Escalation level: 0=normal, 1=warning, 2=critical. */
  escalationLevel?: number;
  /** Whether this chain event has been resolved/concluded. */
  resolved?: boolean;
}

export type EquipmentSlot = "notebook" | "video" | "travel" | "network" | "analysis";

export type EquipmentItemId = string;

export interface EquipmentLoadout {
  notebook: EquipmentItemId;
  video: EquipmentItemId;
  travel: EquipmentItemId;
  network: EquipmentItemId;
  analysis: EquipmentItemId;
}

export interface EquipmentInventory {
  /** All items the scout has purchased (can re-equip without repurchasing). */
  ownedItems: EquipmentItemId[];
  /** Currently equipped items per slot. */
  loadout: EquipmentLoadout;
}

export interface FinancialRecord {
  /** Current balance. */
  balance: number;
  /** Monthly income (salary). */
  monthlyIncome: number;
  /** Monthly expenses breakdown. */
  expenses: Record<ExpenseType, number>;
  /** @deprecated Use `equipment` loadout instead. Kept for save migration. */
  equipmentLevel: number;
  /** History of transactions. */
  transactions: { week: number; season: number; amount: number; description: string }[];
  /** 5-slot equipment loadout and owned items. */
  equipment?: EquipmentInventory;

  // --- Economics Revamp Fields ---

  /** Career path this financial record tracks. */
  careerPath: CareerPath;
  /** Independent tier (only for independent path). */
  independentTier?: IndependentTier;

  // Revenue tracking
  reportSalesRevenue: number;
  placementFeeRevenue: number;
  retainerRevenue: number;
  consultingRevenue: number;
  sellOnRevenue: number;
  bonusRevenue: number;

  // Contracts & records
  retainerContracts: RetainerContract[];
  activeLoan?: Loan;
  placementFeeRecords: PlacementFeeRecord[];
  reportListings: ReportListing[];
  consultingContracts: ConsultingContract[];

  // Assets
  office: Office;
  employees: AgencyEmployee[];
  lifestyle: LifestyleConfig;
  completedCourses: string[];
  activeEnrollment?: CourseEnrollment;
  ownedVehicle?: { name: string; value: number; travelBonus: number };

  // Pending offers (generated weekly, accepted/declined by player)
  pendingRetainerOffers: RetainerContract[];
  pendingConsultingOffers: ConsultingContract[];

  // Market state
  marketTemperature: MarketTemperature;
  activeEconomicEvents: EconomicEvent[];

  // --- Agency overhaul fields ---
  clientRelationships: ClientRelationship[];
  pendingEmployeeEvents: EmployeeEvent[];
  satelliteOffices: SatelliteOffice[];
  awards: AwardRecord[];
}

export type ExpenseType =
  | "rent"
  | "travel"
  | "subscriptions"
  | "equipment"
  | "npcSalaries"
  | "other"
  | "lifestyle"
  | "officeCost"
  | "employeeSalaries"
  | "marketing"
  | "loanPayment"
  | "courseFees"
  | "insurance";

export type RivalPersonality = "aggressive" | "methodical" | "connected" | "lucky";

export interface RivalScout {
  id: string;
  name: string;
  /** Quality 1–5. Higher = more competitive. */
  quality: number;
  /** Specialization. */
  specialization: Specialization;
  /** Club the rival works for. */
  clubId: string;
  /** Players the rival is currently tracking. */
  targetPlayerIds: string[];
  /** Reputation 0–100. */
  reputation: number;
  /** Personality archetype affecting how the rival behaves. */
  personality: RivalPersonality;
  /** Whether this rival is the player's primary nemesis. */
  isNemesis: boolean;
  /** Player IDs that both this rival and the player-scout are competing for. */
  competingForPlayers: string[];
  /** The playerId being actively scouted this week. */
  currentTarget?: string;
  /** Scouting progress per player: playerId → observation count (0–5). */
  scoutingProgress: Record<string, number>;
  /** Week when the rival will submit their scouting report. */
  reportDeadline?: number;
  /** The fixtureId where this rival was last spotted. */
  lastSeenAtFixture?: string;
  /** How quickly the rival moves on targets, 0–1. */
  aggressiveness: number;
  /** Budget tier of the rival's employer club — affects which players they target. */
  budgetTier: "low" | "medium" | "high";
}

export type ToolId =
  | "videoEditor"
  | "dataSubscription"
  | "scoutingApp"
  | "travelPlanner"
  | "contactManager"
  | "reportTemplates"
  | "youthDatabase"
  | "performanceTracker"
  | "networkAnalyzer";

export interface ManagerProfile {
  clubId: string;
  managerName: string;
  preference: ScoutingPreference;
  /** How much weight the manager gives to scouting reports, 0–1. */
  reportInfluence: number;
  /** Tactical system preference. */
  preferredFormation: string;
}

// =============================================================================
// PHASE 3: POLISH & PERSISTENCE
// =============================================================================

export interface TransferWindowState {
  type: TransferWindowType;
  /** Whether the window is currently open. */
  isOpen: boolean;
  /** Week the window opens. */
  openWeek: number;
  /** Week the window closes. */
  closeWeek: number;
  /** How many urgent requests have been made this window. */
  urgentRequestCount: number;
}

export type TransferWindowType = "summer" | "winter";

export interface DaySchedule {
  week: number;
  season: number;
  day: number;
  /** 3 slots per day during transfer windows. */
  slots: (Activity | null)[];
}

export interface SeasonEvent {
  id: string;
  type: SeasonEventType;
  name: string;
  /** Week range when this event is active. */
  startWeek: number;
  endWeek: number;
  description: string;
  /** Mechanical effects applied each week while the event is active. */
  effects?: SeasonEventEffect[];
  /** Player-facing choices that can be resolved once per event. */
  choices?: SeasonEventChoice[];
  /** Whether the player has resolved this event's choices (if any). */
  resolved?: boolean;
  /** Index of the choice the player selected (if resolved via choice). */
  choiceSelected?: number;
}

/**
 * A single mechanical effect that a season event applies to game state.
 * Effects are processed each week the event is active.
 */
export interface SeasonEventEffect {
  type: SeasonEventEffectType;
  /** Numeric value for the effect (e.g., 0.3 = +30% modifier). */
  value: number;
  /** Scope of effect application. Defaults to "global". */
  targetScope?: "global" | "league" | "club";
  /** Optional target entity ID (league or club) for scoped effects. */
  targetId?: string;
}

export type SeasonEventEffectType =
  | "transferPriceModifier"
  | "scoutingCostModifier"
  | "fatigueModifier"
  | "reputationBonus"
  | "youthIntake"
  | "playerAvailability"
  | "injuryRiskModifier"
  | "attributeRevealBonus";

/**
 * A choice presented to the player during a season event.
 * Choosing an option replaces the event's base effects with the choice's effects.
 */
export interface SeasonEventChoice {
  label: string;
  description: string;
  effects: SeasonEventEffect[];
}

export type SeasonEventType =
  | "preSeasonTournament"
  | "summerTransferWindow"
  | "winterTransferWindow"
  | "internationalBreak"
  | "endOfSeasonReview"
  | "youthCup";

// =============================================================================
// PHASE 4: LEGACY & ANALYTICS
// =============================================================================

/**
 * Tracks a player discovered by the scout across seasons.
 */
export interface DiscoveryRecord {
  playerId: string;
  /** Week and season when the scout first observed the player. */
  discoveredWeek: number;
  discoveredSeason: number;
  /** Player's CA at discovery. */
  initialCA: number;
  /** Player's PA at discovery (if known). */
  initialPA?: number;
  /** Snapshots of the player's career at end of each season. */
  careerSnapshots: CareerSnapshot[];
  /** Whether this was a wonderkid discovery. */
  wasWonderkid: boolean;
  /** Scout's prediction accuracy (set retroactively). */
  predictionAccuracy?: number;
  /** Club ID where an unsigned youth was placed (youth scouting). */
  placementClubId?: string;
  /** How the youth was placed (academy intake or youth contract). */
  placementType?: "academyIntake" | "youthContract";
  /** Week the placement occurred. */
  placementWeek?: number;
  /** Season the placement occurred. */
  placementSeason?: number;
  /** Career outcome classification set retrospectively. */
  careerOutcome?: "starPlayer" | "squadPlayer" | "released" | "retired";
}

export interface CareerSnapshot {
  season: number;
  clubId: string;
  currentAbility: number;
  position: Position;
  age: number;
}

export interface LeaderboardEntry {
  id: string;
  scoutName: string;
  /** Overall score combining multiple metrics. */
  score: number;
  /** End-of-season the entry was submitted. */
  season: number;
  reputation: number;
  totalDiscoveries: number;
  predictionAccuracy: number;
  /** Timestamp of submission. */
  submittedAt: number;
}

/**
 * Monthly snapshot of scout performance for analytics.
 */
export interface ScoutPerformanceSnapshot {
  season: number;
  week: number;
  /** Rolling accuracy metric. */
  accuracy: number;
  /** Cumulative reports submitted. */
  totalReports: number;
  /** Average report quality. */
  avgQuality: number;
  /** Discovery rate (discoveries / reports). */
  discoveryRate: number;
  /** Skill levels at this snapshot. */
  skills: Record<ScoutSkill, number>;
  /** Reputation at this snapshot. */
  reputation: number;
}

// =============================================================================
// YOUTH SCOUTING SYSTEM
// =============================================================================

export type YouthVenueType =
  | "schoolMatch"
  | "grassrootsTournament"
  | "streetFootball"
  | "academyTrialDay"
  | "youthFestival"
  | "followUpSession"
  | "parentCoachMeeting";

export interface UnsignedYouth {
  id: string;
  player: Player;
  visibility: number;      // 0-100
  buzzLevel: number;       // 0-100
  discoveredBy: string[];  // scout IDs
  regionId: string;        // sub-region ID
  country: string;
  venueAppearances: YouthVenueType[];
  generatedSeason: number;
  placed: boolean;
  placedClubId?: string;
  retired: boolean;
}

export interface PlacementReport {
  id: string;
  unsignedYouthId: string;
  targetClubId: string;
  scoutId: string;
  conviction: ConvictionLevel;
  clubResponse?: "pending" | "accepted" | "rejected" | "trial";
  placementType?: "academyIntake" | "youthContract";
  qualityScore: number;    // 0-100
  week: number;
  season: number;
}

export interface GutFeeling {
  id: string;
  playerId: string;
  narrative: string;
  triggerDomain: AttributeDomain;
  reliability: number;     // 0-1
  wasAccurate?: boolean;
  week: number;
  season: number;
}

export type AlumniMilestoneType =
  | "firstTeamDebut"
  | "firstGoal"
  | "internationalCallUp"
  | "wonderkidStatus"
  | "transfer";

export interface AlumniMilestone {
  type: AlumniMilestoneType;
  week: number;
  season: number;
  description: string;
  notified: boolean;
}

// --- F12: Youth Pipeline Tracking types ---

export type AlumniStatus =
  | "academy"
  | "firstTeam"
  | "loaned"
  | "released"
  | "retired"
  | "transferred";

export type AlumniCareerUpdateType =
  | "debut"
  | "firstGoal"
  | "teamOfWeek"
  | "loanMove"
  | "transfer"
  | "released"
  | "internationalCall"
  | "injury"
  | "captaincy";

export interface AlumniCareerUpdate {
  week: number;
  season: number;
  type: AlumniCareerUpdateType;
  description: string;
}

export interface AlumniSeasonStats {
  season: number;
  appearances: number;
  goals: number;
  assists: number;
  avgRating: number;
  clubId: string;
}

export interface AlumniRecord {
  id: string;
  playerId: string;
  placedClubId: string;
  currentClubId: string;
  milestones: AlumniMilestone[];
  careerSnapshots: CareerSnapshot[];
  placedWeek: number;
  placedSeason: number;
  /** Career update timeline for pipeline tracking (F12). */
  careerUpdates: AlumniCareerUpdate[];
  /** Current career status of the alumni (F12). */
  currentStatus: AlumniStatus;
  /** Season-by-season stats for the alumni (F12). */
  seasonStats: AlumniSeasonStats[];
  /** Whether this alumni graduated to the scout's contact network (F12). */
  becameContact: boolean;
}

export interface LegacyScore {
  youthFound: number;
  firstTeamBreakthroughs: number;
  internationalCapsFromFinds: number;
  totalScore: number;
  // Extended legacy fields
  clubsWorkedAt: number;
  countriesScouted: number;
  careerHighTier: number;
  totalSeasons: number;
  bestDiscoveryName: string;
  bestDiscoveryPA: number;
  scenariosCompleted: number;
}

export interface SubRegion {
  id: string;
  name: string;
  country: string;
  familiarity: number;     // 0-100
}

// =============================================================================
// FIRST-TEAM SCOUTING SYSTEM
// =============================================================================

/**
 * A directive from a club manager specifying a transfer target profile.
 * Generated at season start and updated mid-season during transfer windows.
 */
export interface ManagerDirective {
  id: string;
  clubId: string;
  managerId: string;
  /** The position the manager wants to strengthen. */
  position: Position;
  /** Priority: higher = more urgently needed. */
  priority: "low" | "medium" | "high" | "critical";
  /** Budget allocated for this position (subset of club budget). */
  budgetAllocation: number;
  /** Age range the manager prefers. */
  ageRange: [number, number];
  /** Minimum CA star rating acceptable. */
  minCAStars: number;
  /** Key attributes the manager values for this role. */
  keyAttributes: PlayerAttribute[];
  /** Reports submitted against this directive. */
  submittedReportIds: string[];
  /** Whether this directive has been fulfilled (player signed). */
  fulfilled: boolean;
  /** Season this directive was issued. */
  season: number;
  /** Optional tactical notes from the manager. */
  tacticalNotes?: string;
  /** The tactical role the manager wants for this position. */
  preferredRole?: PlayerRole;
}

/**
 * Club response to a submitted scout report, part of the first-team pipeline.
 */
export type ClubResponseType =
  | "ignored"        // Report doesn't match any directive
  | "interested"     // Added to shortlist
  | "trial"          // Club arranges a trial match
  | "doesNotFit"     // Tactical mismatch
  | "tooExpensive"   // Over budget
  | "signed"         // Transfer completed
  | "loanSigned";    // Loan deal completed

export interface ClubResponse {
  reportId: string;
  directiveId?: string;
  response: ClubResponseType;
  feedback: string;
  /** Reputation delta from this response. */
  reputationDelta: number;
  /** Week the response was given. */
  week: number;
  season: number;
}

/**
 * Tracks a player who was signed based on the scout's recommendation.
 * Mirrors the youth AlumniRecord for first-team scouts.
 */
export interface TransferRecord {
  id: string;
  playerId: string;
  reportId: string;
  directiveId?: string;
  fromClubId: string;
  toClubId: string;
  transferFee: number;
  /** Season the transfer occurred. */
  season: number;
  week: number;
  /** Whether this was a loan deal. */
  isLoan: boolean;
  /** Performance ratings each season post-transfer (0-100). */
  seasonPerformance: Array<{
    season: number;
    rating: number;
    appearances: number;
    goals: number;
    assists: number;
    /** Average match rating on 1-10 scale (present when derived from real match data). */
    avgMatchRating?: number;
  }>;
  /** Overall outcome classification set retrospectively. */
  outcome?: "hit" | "decent" | "flop" | "tooEarly";
}

/**
 * System fit analysis result — how well a player matches a club's tactical system.
 * Generated by the first-team perk system.
 */
export interface SystemFitResult {
  playerId: string;
  clubId: string;
  /** Overall fit score 0-100. */
  overallFit: number;
  /** Position compatibility score 0-100. */
  positionFit: number;
  /** How well player attributes align with club play style 0-100. */
  styleFit: number;
  /** Age bracket appropriateness 0-100. */
  ageFit: number;
  /** Role suitability score 0-100. */
  roleFit: number;
  /** Tactical style compatibility score 0-100. */
  tacticalFit: number;
  /** Suggested best role for the player at this club. */
  suggestedRole?: PlayerRole;
  /** Key strengths matching system. */
  fitStrengths: string[];
  /** Areas of concern. */
  fitWeaknesses: string[];
}

// =============================================================================
// DATA SCOUTING SYSTEM
// =============================================================================

/**
 * A prediction made by a data scout about a player's future performance.
 * Tracked over time for accuracy scoring.
 */
export interface Prediction {
  id: string;
  playerId: string;
  scoutId: string;
  /** What the scout predicts. */
  type: "breakout" | "decline" | "transfer" | "injury" | "topScorer" | "relegation";
  /** Free-text prediction statement. */
  statement: string;
  /** Season the prediction was made. */
  madeInSeason: number;
  madeInWeek: number;
  /** Season by which the prediction should resolve. */
  resolveBySeason: number;
  /** Whether the prediction was correct (set when resolved). */
  wasCorrect?: boolean;
  /** Whether the prediction has been resolved. */
  resolved: boolean;
  /** Confidence at time of prediction 0-1. */
  confidence: number;
}

/**
 * A junior data analyst managed by a data scout.
 * Part of the analytics department management sub-game.
 */
export interface DataAnalyst {
  id: string;
  name: string;
  /** Skill level 1-20 (affects quality of passive reports). */
  skill: number;
  /** League ID this analyst is assigned to monitor. */
  assignedLeagueId?: string;
  /** Specialization focus. */
  focus: "general" | "youth" | "undervalued" | "formPlayers";
  /** Weekly salary cost. */
  salary: number;
  /** How many seasons they've worked for you. */
  tenure: number;
  /** Morale/satisfaction 0-100 (affects quality). */
  morale: number;
}

/**
 * Statistical profile generated by data scouting for a player.
 * Contains per-90 stats, percentile ranks, and trends.
 */
export interface StatisticalProfile {
  playerId: string;
  /** Per-90 minute statistics. */
  per90: {
    goals: number;
    assists: number;
    passCompletion: number;
    tacklesWon: number;
    interceptions: number;
    aerialDuelsWon: number;
    dribbleSuccess: number;
    shotsOnTarget: number;
  };
  /** Percentile rank within league (0-100). */
  percentiles: {
    goals: number;
    assists: number;
    passCompletion: number;
    tacklesWon: number;
    interceptions: number;
    aerialDuelsWon: number;
    dribbleSuccess: number;
    shotsOnTarget: number;
  };
  /** Trend direction for each stat over last 10 games. */
  trends: {
    goals: "rising" | "stable" | "falling";
    assists: "rising" | "stable" | "falling";
    passCompletion: "rising" | "stable" | "falling";
    tacklesWon: "rising" | "stable" | "falling";
    interceptions: "rising" | "stable" | "falling";
  };
  /** Season this profile was generated. */
  season: number;
  /** Week this profile was last updated. */
  lastUpdated: number;
}

/**
 * A statistical anomaly flagged by the data scouting system.
 * Represents outlier performance worthy of investigation.
 */
export interface AnomalyFlag {
  id: string;
  playerId: string;
  /** Which stat is anomalous. */
  stat: string;
  /** Direction of the anomaly. */
  direction: "positive" | "negative";
  /** How extreme the anomaly is, in standard deviations. */
  severity: number;
  /** Human-readable description. */
  description: string;
  /** Whether the scout has investigated this anomaly. */
  investigated: boolean;
  /** Week/season when flagged. */
  week: number;
  season: number;
}

/**
 * Analyst report generated passively by assigned data analysts.
 */
export interface AnalystReport {
  id: string;
  analystId: string;
  leagueId: string;
  /** Player IDs highlighted in this report. */
  highlightedPlayerIds: string[];
  /** Anomaly flags found. */
  anomalies: AnomalyFlag[];
  /** Quality score 0-100 (driven by analyst skill). */
  quality: number;
  week: number;
  season: number;
}

// =============================================================================
// DAY-BY-DAY SIMULATION
// =============================================================================

export interface DayInteractionOption {
  id: string;
  label: string;
  description: string;
}

export interface DayInteractionState {
  /** Prompt shown to the player for this day/activity. */
  prompt: string;
  /** Available choices for this day. */
  options: DayInteractionOption[];
  /** Choice selected by the player (if resolved). */
  selectedOptionId?: string;
  /** Optional focused youth player for focus-style choices. */
  focusedPlayerId?: string;
  /** Optional focused youth players for split-focus choices (max 3). */
  focusedPlayerIds?: string[];
  /** Maximum number of players that can be selected for focus. */
  maxFocusPlayers?: number;
}

export interface DayResult {
  /** Day index 0-6 (Mon-Sun). */
  dayIndex: number;
  /** "Monday", "Tuesday", etc. */
  dayName: string;
  /** The activity for this day (null = rest/free day). */
  activity: Activity | null;
  /** Players observed during this day's activity. */
  observations: { playerId: string; playerName: string; topAttributes: string; age?: number; position?: string }[];
  /** Number of new players discovered. */
  playersDiscovered: number;
  /** Names of reports written. */
  reportsWritten: string[];
  /** Statistical profiles generated (data activities). */
  profilesGenerated: number;
  /** Anomalies flagged (data activities). */
  anomaliesFound: number;
  /** XP gained per scout skill from this day's activity. */
  xpGained: Partial<Record<ScoutSkill, number>>;
  /** Fatigue change from this day's activity. */
  fatigueChange: number;
  /** Quality tier narrative for this activity. */
  narrative: string;
  /** Inbox messages generated by this day's activity. */
  inboxMessages: InboxMessage[];
  /** Optional interactive choice state for this day. */
  interaction?: DayInteractionState;
}

export interface WeekSimulationState {
  /** Results for each day processed so far. */
  dayResults: DayResult[];
  /** Current day: -1 = not started, 0-6 = in progress, 7 = all days done. */
  currentDay: number;
  /** True when all days are done but the world tick hasn't run yet. */
  pendingWorldTick: boolean;
  /** Focus-pinned youth target selected during simulation (if any). */
  focusedYouthPlayerId?: string;
  /** Focus-pinned youth targets selected during simulation (if any). */
  focusedYouthPlayerIds?: string[];
  /** Pre-computed youth venue results — applied during advanceWeek to avoid double-processing. */
  youthVenueResults?: {
    updatedUnsignedYouth: Record<string, UnsignedYouth>;
    newObservations: Record<string, Observation>;
    newDiscoveries: DiscoveryRecord[];
    totalObservations: number;
    totalDiscoveries: number;
  };
}

// =============================================================================
// PERSONALITY PROFILE SYSTEM (F9)
// =============================================================================

/**
 * Personality archetypes describe the dominant character pattern of a player.
 * Each archetype implies default values for transfer willingness, dressing room
 * impact, form volatility, and big-match temperament. These can be further
 * adjusted by the player's individual personality traits.
 */
export type PersonalityArchetype =
  | "leader"
  | "mercenary"
  | "homesick"
  | "ambitious"
  | "loyal"
  | "disruptive"
  | "introvert"
  | "professional"
  | "hothead"
  | "clutch";

/**
 * A player's full personality profile, combining a dominant archetype with
 * numeric modifiers that affect gameplay: transfer willingness, dressing room
 * impact, form volatility, and big-match performance.
 *
 * The profile is partially hidden from the scout — `hiddenUntilRevealed` is
 * true until the scout has made enough observations to uncover the archetype,
 * and `revealedTraits` tracks which individual personality traits have been
 * discovered so far.
 */
export interface PersonalityProfile {
  /** Dominant character archetype. */
  archetype: PersonalityArchetype;
  /** Individual personality traits (2-4, from the PersonalityTrait pool). */
  traits: PersonalityTrait[];
  /** 0-1 scale: how willing the player is to transfer (mercenary=0.9, loyal=0.2). */
  transferWillingness: number;
  /** -3 to +3: effect on team morale when in the dressing room (leader=+3, disruptive=-2). */
  dressingRoomImpact: number;
  /** 0-1 scale: how volatile the player's form is (professional=0.2, hothead=0.8). */
  formVolatility: number;
  /** -2 to +2: rating modifier in important matches (clutch=+2, introvert=-1). */
  bigMatchModifier: number;
  /** True until the scout has gathered enough observations to reveal the archetype. */
  hiddenUntilRevealed: boolean;
  /** Personality traits discovered by the scout so far. */
  revealedTraits: PersonalityTrait[];
}

// =============================================================================
// INJURY SYSTEM
// =============================================================================

export type InjuryType =
  | "muscle"
  | "ligament"
  | "fracture"
  | "concussion"
  | "knock"
  | "fatigue";

export type InjurySeverity =
  | "minor"
  | "moderate"
  | "serious"
  | "career-threatening";

export interface Injury {
  id: string;
  playerId: string;
  type: InjuryType;
  severity: InjurySeverity;
  recoveryWeeks: number;
  weeksRemaining: number;
  /** The fixture in which the injury occurred (if match-related). */
  occurredInMatch?: string;
  /** Match minute at which the injury occurred. */
  minute?: number;
  /** Elevated reinjury risk factor (0-1), active for 4 weeks post-return. */
  reinjuryRisk: number;
  /** Week number when the injury occurred. */
  occurredWeek: number;
  /** Season when the injury occurred. */
  occurredSeason: number;
}

export interface InjuryHistory {
  playerId: string;
  injuries: Injury[];
  totalWeeksMissed: number;
  /** Accumulated injury proneness (0-1), increases with repeated injuries. */
  injuryProneness: number;
  /** Weeks remaining in reinjury-risk window after return (0 = no elevated risk). */
  reinjuryWindowWeeksLeft: number;
}

// =============================================================================
// REPORT COMPARISON (F11)
// =============================================================================

/**
 * Per-attribute delta between two or more reports: shows how each player
 * compares on the same attribute scale.
 */
export interface AttributeComparisonEntry {
  attribute: PlayerAttribute;
  domain: AttributeDomain;
  /** One value per report in the same order as the input array. */
  values: number[];
  /** Confidence ranges per report. */
  ranges: Array<[number, number]>;
  /** Highest value among reports. */
  best: number;
  /** Index of the report with the best value. */
  bestIndex: number;
}

/**
 * Summary object returned by `compareReports`.
 */
export interface ReportComparison {
  /** The report IDs that were compared, in order. */
  reportIds: string[];
  /** Player IDs corresponding to each report. */
  playerIds: string[];
  /** Attribute-by-attribute comparison rows. */
  attributes: AttributeComparisonEntry[];
  /** Per-report aggregate metrics. */
  metrics: ReportComparisonMetrics[];
  /** Textual summary of the key differences. */
  summaryText: string;
}

/**
 * Aggregate comparison metrics for a single report within a comparison set.
 */
export interface ReportComparisonMetrics {
  reportId: string;
  playerId: string;
  perceivedCAStars: number | null;
  perceivedPARange: [number, number] | null;
  estimatedValue: number;
  conviction: ConvictionLevel;
  strengthCount: number;
  weaknessCount: number;
  /** Average estimated attribute value across all assessments. */
  avgAttribute: number;
  /** Value-for-money score (0-100), if a transfer fee is provided. */
  valueScore: number | null;
  /** Position fit percentage (0-100), if calculated. */
  positionFit: number | null;
}

// =============================================================================
// REGIONAL SCOUTING DEPTH (F13)
// =============================================================================

/**
 * Tracks the scout's accumulated knowledge of a specific country.
 * Knowledge grows through scouting activity (reports, travel, contacts) and
 * unlocks hidden leagues, cultural insights, and local contacts.
 */
export interface RegionalKnowledge {
  /** The country key this knowledge record relates to. */
  countryId: string;
  /** Knowledge level from 0 (unknown) to 100 (complete mastery). */
  knowledgeLevel: number;
  /** IDs of hidden leagues the scout has discovered in this country. */
  discoveredLeagues: string[];
  /** Cultural insights the scout has accumulated. */
  culturalInsights: CulturalInsight[];
  /** Auto-generated local contact IDs unlocked at knowledge thresholds. */
  localContacts: string[];
  /** Scouting efficiency multiplier derived from knowledge level (0.5–1.5). */
  scoutingEfficiency: number;
}

/**
 * A cultural insight gained from deep regional knowledge.
 * Provides thematic flavor and minor gameplay effects.
 */
export interface CulturalInsight {
  /** Category of the insight. */
  type: "playingStyle" | "developmentCulture" | "mentalityPattern" | "physicalTrait";
  /** Human-readable description of the insight. */
  description: string;
  /** What the insight unlocks or reveals for the player. */
  gameplayEffect: string;
}

/**
 * A hidden lower-tier league that can be discovered through regional knowledge.
 * Contains undiscovered talent at lower current ability but potentially high PA.
 */
export interface HiddenLeague {
  /** Unique identifier for the hidden league. */
  id: string;
  /** The country this league belongs to. */
  countryId: string;
  /** Display name of the league. */
  name: string;
  /** League tier (3+ — these are below the main scoutable leagues). */
  tier: number;
  /** Minimum knowledgeLevel required to discover this league. */
  discoveryThreshold: number;
  /** Current ability range of players in this league [min, max] on 1-200 scale. */
  playerQualityRange: [number, number];
  /** Probability (0–1) that a player in this league has high potential ability. */
  talentDensity: number;
}

// =============================================================================
// QUICK SCOUT MODE (F17)
// =============================================================================

/**
 * Priorities for the auto-schedule system. The scheduler uses these to
 * decide which activities to fill empty days with.
 */
export interface QuickScoutPriorities {
  /** Player IDs to prioritize for match observation. */
  targetPlayerIds: string[];
  /** Whether to prioritize training on weakest skills. */
  trainWeakSkills: boolean;
  /** Whether to prioritize network meetings for decaying contacts. */
  maintainContacts: boolean;
  /** Whether to include report writing for well-observed players. */
  writeReports: boolean;
}

/**
 * Summary of a single week produced during batch advancement. */
export interface BatchWeekSummary {
  week: number;
  season: number;
  fatigueChange: number;
  matchesAttended: number;
  reportsWritten: number;
  meetingsHeld: number;
  newMessages: number;
  playersDiscovered: number;
  observationsGenerated: number;
  /** Key events that happened this week (narrative text). */
  keyEvents: string[];
}

/**
 * Aggregated result of advancing multiple weeks at once. */
export interface BatchAdvanceResult {
  /** Per-week breakdown. */
  weekSummaries: BatchWeekSummary[];
  /** Total weeks advanced. */
  weeksAdvanced: number;
  /** Starting fatigue before batch. */
  startingFatigue: number;
  /** Final fatigue after batch. */
  endingFatigue: number;
  /** Total skill XP gained across all weeks, keyed by skill name. */
  totalSkillXp: Record<string, number>;
  /** Total attribute XP gained across all weeks, keyed by attribute name. */
  totalAttributeXp: Record<string, number>;
  /** Total new messages received. */
  totalNewMessages: number;
  /** Total players discovered. */
  totalPlayersDiscovered: number;
  /** Total observations generated. */
  totalObservationsGenerated: number;
  /** Whether an end-of-season was triggered during the batch. */
  seasonTransitionOccurred: boolean;
}

/**
 * Result of delegating a scouting task to an NPC scout. */
export interface DelegationResult {
  /** Updated NPC scout after accepting the task. */
  npcScout: NPCScout;
  /** Estimated weeks until the delegation completes. */
  estimatedWeeks: number;
  /** Whether the delegation was accepted (false if NPC is too fatigued). */
  accepted: boolean;
  /** Reason for rejection, if not accepted. */
  rejectionReason?: string;
}

/**
 * An active delegation assignment - NPC scouting a specific player. */
export interface NPCDelegation {
  id: string;
  npcScoutId: string;
  playerId: string;
  /** Week the delegation started. */
  startWeek: number;
  /** Week the delegation completes. */
  completionWeek: number;
  /** Whether the delegation has been completed. */
  completed: boolean;
}

// =============================================================================
// F14: FINANCIAL STRATEGY LAYER
// =============================================================================

/** Data subscription tier affecting data scouting quality. */
export type DataSubscriptionTier = "none" | "basic" | "premium" | "elite";

/** Travel budget tier affecting scout fatigue on trips. */
export type TravelBudgetTier = "economy" | "standard" | "business";

/** Office equipment tier affecting report quality. */
export type OfficeEquipmentTier = "basic" | "upgraded" | "professional";

/**
 * Scouting infrastructure investments that provide passive bonuses
 * to various aspects of the scouting workflow.
 */
export interface ScoutingInfrastructure {
  /** Data subscription level — affects data scouting quality. */
  dataSubscription: DataSubscriptionTier;
  /** Travel budget level — affects fatigue from travel. */
  travelBudget: TravelBudgetTier;
  /** Office equipment level — affects report quality. */
  officeEquipment: OfficeEquipmentTier;
  /** Costs breakdown: weekly recurring + one-time paid so far. */
  investmentCosts: { weekly: number; oneTime: number };
}

/**
 * An assistant scout that can be hired to perform scouting tasks
 * while the player focuses on other activities.
 */
export interface AssistantScout {
  /** Unique identifier. */
  id: string;
  /** Display name. */
  name: string;
  /** Skill level 1-10 (affects observation quality). */
  skill: number;
  /** Weekly salary cost. */
  salary: number;
  /** Player ID currently assigned to observe, if any. */
  assignedPlayerId?: string;
  /** Region currently assigned to scout, if any. */
  assignedRegion?: string;
  /** Fatigue 0-100. */
  fatigue: number;
  /** Lifetime count of reports completed. */
  reportsCompleted: number;
}

/** Trip quality level for individual scouting trips. */
export type TripQualityLevel = "budget" | "standard" | "premium";

/**
 * Trip quality configuration affecting cost, fatigue, and observation accuracy.
 */
export interface TripQuality {
  /** Quality level. */
  level: TripQualityLevel;
  /** Multiplier on base travel cost (0.5 = half price, 1.8 = 80% more). */
  costMultiplier: number;
  /** Multiplier on fatigue from traveling (1.5 = 50% more fatigue, 0.6 = 40% less). */
  fatigueMultiplier: number;
  /** Additive bonus to observation accuracy (-0.1, 0, +0.15). */
  observationBonus: number;
}

/**
 * Aggregated effects of all infrastructure investments, computed from
 * the ScoutingInfrastructure state.
 */
export interface InfrastructureEffects {
  /** Additive bonus to data scouting accuracy (0 to 0.20). */
  dataQualityBonus: number;
  /** Multiplier on travel fatigue (1.0 = normal, 0.6 = 40% less). */
  travelFatigueMultiplier: number;
  /** Additive bonus to report quality (0 to 0.15). */
  reportQualityBonus: number;
  /** Weekly maintenance cost for all infrastructure. */
  weeklyCost: number;
}

// =============================================================================
// WEEK PREVIEW (F16)
// =============================================================================

/** A fixture that features a player of interest to the scout. */
export interface PreviewMatch {
  fixtureId: string;
  homeClubId: string;
  awayClubId: string;
  leagueId: string;
  /** Player IDs from the scout's watchlist appearing in this fixture. */
  watchlistPlayerIds: string[];
  /** Player IDs relevant to active manager directives in this fixture. */
  directivePlayerIds: string[];
  /** Combined relevance score (higher = more important to attend). */
  relevanceScore: number;
}

/** Congestion level for the week. */
export type CongestionLevel = "light" | "moderate" | "heavy";

/** A suggestion for a single day slot in the schedule. */
export interface ScheduleSuggestion {
  dayIndex: number;
  activity: Activity;
  reason: string;
}

/** Priority weights the player can set for schedule suggestions. */
export interface SchedulePriorities {
  /** Weight given to watching tracked/targeted players (0-1). */
  watchlistWeight: number;
  /** Weight given to fulfilling manager directives (0-1). */
  directiveWeight: number;
  /** Weight given to rest/fatigue recovery (0-1). */
  restWeight: number;
}

/** Complete week preview result from generateWeekPreview. */
export interface WeekPreview {
  /** Fixtures featuring players of interest, sorted by relevance. */
  relevantMatches: PreviewMatch[];
  /** Total number of fixtures this week across all leagues. */
  totalFixtures: number;
  /** Congestion level based on fixture density. */
  congestion: CongestionLevel;
  /** Whether the scout should consider resting based on fatigue. */
  fatigueWarning: boolean;
  /** Whether the scout is abroad this week. */
  isAbroad: boolean;
  /** Suggested schedule with reasons. */
  suggestions: ScheduleSuggestion[];
}

// =============================================================================
// F20: DATA VISUALIZATION DASHBOARD
// =============================================================================

/** A single point in a scatter plot visualization. */
export interface ScatterDataPoint {
  playerId: string;
  label: string;
  x: number;
  y: number;
  /** Position group for color coding. */
  category: Position;
  /** True if this player has an active anomaly flag. */
  isAnomaly: boolean;
}

/** Configuration and data for a scatter plot. */
export interface ScatterPlotData {
  points: ScatterDataPoint[];
  xLabel: string;
  yLabel: string;
  xMax: number;
  yMax: number;
}

/** A single cell in a heat map visualization. */
export interface HeatMapCell {
  /** Country or region identifier. */
  key: string;
  /** Display label for the cell. */
  label: string;
  /** Intensity value, normalized to 0-1. */
  intensity: number;
  /** Raw count (observations, scouts, etc.). */
  rawValue: number;
}

/** Configuration and data for a heat map. */
export interface HeatMapData {
  cells: HeatMapCell[];
  title: string;
  maxValue: number;
}

/** A single data point in a development trend line. */
export interface TrendDataPoint {
  season: number;
  value: number;
}

/** One player's development trajectory. */
export interface TrendLineData {
  playerId: string;
  label: string;
  points: TrendDataPoint[];
  color: string;
}

/** A single bar in a bar chart. */
export interface BarChartBar {
  key: string;
  label: string;
  value: number;
  /** Secondary value for comparison (optional). */
  secondaryValue?: number;
}

/** Configuration and data for a bar chart. */
export interface BarChartData {
  bars: BarChartBar[];
  yLabel: string;
  maxValue: number;
}

/** A single axis on a radar chart. */
export interface RadarAxis {
  key: string;
  label: string;
  value: number;
  /** Maximum possible value on this axis. */
  max: number;
}

/** Configuration and data for a radar chart. */
export interface RadarChartData {
  axes: RadarAxis[];
  label: string;
}

// =============================================================================
// DISCIPLINE / CARD SYSTEM
// =============================================================================

/**
 * Reason a card was shown. Drives suspension length for red cards
 * and commentary text.
 */
export type CardReason =
  | "recklessTackle"
  | "professionalFoul"
  | "dissent"
  | "timewasting"
  | "handball"
  | "violentConduct";

/**
 * A single card event that occurred during a match.
 */
export interface CardEvent {
  type: "yellow" | "red";
  playerId: string;
  fixtureId: string;
  minute: number;
  reason: CardReason;
}

/**
 * Tracks a player's disciplinary record across a season.
 * Stored both on the Player and in GameState.disciplinaryRecords.
 */
export interface DisciplinaryRecord {
  playerId: string;
  season: number;
  yellowCards: number;
  redCards: number;
  /** Remaining match suspensions — player is unavailable when > 0. */
  suspensionWeeksRemaining: number;
  /** Full history of card events this season. */
  cardHistory: CardEvent[];
}

// =============================================================================
// EVENT CHAINS (F2)
// =============================================================================

/**
 * Tracks a multi-step narrative event chain.
 * Chains link related NarrativeEvents across multiple weeks,
 * allowing choices at earlier steps to influence later outcomes.
 */
export interface EventChain {
  /** Unique chain identifier. */
  id: string;
  /** Which chain template produced this chain. */
  templateKey: string;
  /** The week this chain started (absolute). */
  startWeek: number;
  /** Current step within the chain (0-based). */
  currentStep: number;
  /** Total number of steps in this chain. */
  maxSteps: number;
  /** Whether the chain has concluded. */
  resolved: boolean;
  /** Choices made at each step (index = step, value = choiceIndex). */
  choiceHistory: number[];
  /** Carried context data (playerId, clubId, playerName, etc.). */
  context: Record<string, string>;
  /** Absolute week when the next step should fire. */
  nextStepWeek: number;
  /** IDs of NarrativeEvents generated by this chain. */
  eventIds: string[];
}

// =============================================================================
// TRANSFER NEGOTIATION SYSTEM (F4)
// =============================================================================

/**
 * Personality of a club during transfer negotiations.
 * Affects starting price, patience, willingness to include add-ons.
 *  - hardball:    starts high (+20% asking), few rounds, rarely accepts add-ons
 *  - reasonable:  fair starting price, moderate patience, open to add-ons
 *  - desperate:   lower asking (-15%), quick to accept, very open to add-ons
 *  - prestige:    price premium (+10%), but easily swayed by club reputation
 */
export type ClubNegotiationPersonality =
  | "hardball"
  | "reasonable"
  | "desperate"
  | "prestige";

/**
 * A single round within a transfer negotiation.
 * Each round represents one offer/counter-offer exchange.
 */
export interface NegotiationRound {
  roundNumber: number;
  /** The buying club's offer amount. */
  offerAmount: number;
  /** The selling club's asking amount. */
  askingAmount: number;
  /** Optional add-on clauses included in this offer. */
  addOns?: TransferAddOn[];
  /** How the selling club responded to this round. */
  response: "accepted" | "rejected" | "countered";
  /** Game week when this round occurred. */
  week: number;
}

/**
 * An add-on clause attached to a transfer offer.
 * Add-ons reduce the upfront fee while deferring costs to future milestones.
 */
export interface TransferAddOn {
  type: "appearanceBonus" | "sellOnClause" | "performanceBonus" | "relegationClause";
  /** Monetary value of the add-on (or percentage for sellOnClause). */
  value: number;
  /** Human-readable description of the trigger condition. */
  trigger?: string;
}

/**
 * A rival club's competing bid for a player under negotiation.
 * Increases urgency and may force the buying club to raise their offer.
 */
export interface RivalBid {
  clubId: string;
  /** The rival's bid amount. */
  amount: number;
  /** Week the rival bid was placed. */
  week: number;
  /** Name of the rival club's scout (flavour). */
  scoutName?: string;
}

/**
 * A multi-round transfer negotiation between two clubs for a player.
 * Created when the scout's club responds "signed" or "interested" and
 * the player initiates a formal transfer process.
 */
export interface TransferNegotiation {
  id: string;
  playerId: string;
  /** The club selling the player. */
  fromClubId: string;
  /** The club buying the player (the scout's club). */
  toClubId: string;
  /** Current phase of the negotiation. */
  phase: "initial" | "counterOffer" | "finalOffer" | "completed" | "collapsed";
  /** History of all offer rounds. */
  rounds: NegotiationRound[];
  /** Maximum rounds before the selling club walks away. */
  maxRounds: number;
  /** Any rival bids that have appeared during negotiation. */
  rivalBids: RivalBid[];
  /** Game week when this negotiation expires if not completed. */
  deadline: number;
  /** The selling club's negotiation personality. */
  clubPersonality: ClubNegotiationPersonality;
  /** Whether a player agent is involved (adds wage/bonus demands). */
  agentInvolved: boolean;
  /** Agent demands if agent is involved. */
  agentDemands?: { wagePremium: number; signingBonus: number };
  /** The initial asking price set by the selling club. */
  initialAskingPrice: number;
  /** Season when this negotiation started. */
  season: number;
  /** Week when this negotiation started. */
  startWeek: number;
}

// =============================================================================
// RIVAL SCOUT ACTIVITIES (F8)
// =============================================================================

/**
 * Represents a notable action by a rival scout, used to display activity
 * history on the Rivals Screen and generate inbox messages.
 */
export interface RivalActivity {
  /** ID of the rival scout who performed this action. */
  rivalId: string;
  /** Type of activity. */
  type: "spotted" | "targetAcquired" | "reportSubmitted" | "playerSigned";
  /** The player involved, if applicable. */
  playerId?: string;
  /** The fixture where the activity occurred, if applicable. */
  fixtureId?: string;
  /** The game week when this activity occurred. */
  week: number;
  /** The season when this activity occurred. */
  season: number;
}

// =============================================================================
// NEW GAME+ / LEGACY MODE (F19)
// =============================================================================

/**
 * The type of bonus a legacy perk provides to a New Game+ career.
 *
 * - `startingContact`   — begin with extra contacts from prior career knowledge
 * - `reputationBoost`   — flat bonus to starting reputation
 * - `skillBonus`        — bonus points to a scout skill
 * - `budgetBonus`       — percentage increase to starting financial balance
 * - `knowledgeRetain`   — retain a fraction of regional knowledge
 * - `fatigueReduction`  — lower starting fatigue ceiling / faster recovery
 */
export type LegacyPerkType =
  | "startingContact"
  | "reputationBoost"
  | "skillBonus"
  | "budgetBonus"
  | "knowledgeRetain"
  | "fatigueReduction";

/**
 * A single legacy perk earned through prior career achievement.
 * Perks are applied when starting a New Game+ run.
 */
export interface LegacyPerk {
  /** Unique perk identifier (e.g. "starting_network", "reputation_head_start"). */
  id: string;
  /** Display name shown in the perk selection UI. */
  name: string;
  /** Short description of what this perk does. */
  description: string;
  /** The mechanical bonus category. */
  type: LegacyPerkType;
  /** Numeric value of the bonus (interpretation depends on `type`). */
  value: number;
  /** The achievement ID or career milestone that unlocked this perk. */
  unlockedBy: string;
}

/**
 * Summary of a single completed career, stored in the legacy profile.
 */
export interface CompletedCareer {
  /** Scout display name for the career history. */
  scoutName: string;
  /** The highest career tier reached during this career. */
  finalTier: number;
  /** Total seasons played in this career. */
  seasonsPlayed: number;
  /** Total player discoveries recorded. */
  totalDiscoveries: number;
  /** Hit rate: fraction of reports that led to successful finds (0-1). */
  hitRate: number;
  /** Primary specialization used in this career. */
  specialization: Specialization;
  /** IDs of scenarios completed during this career. */
  completedScenarios: string[];
  /** The legacy score achieved at career end. */
  legacyScoreTotal: number;
  /** Unix timestamp when this career was completed. */
  completedAt: number;
}

/**
 * Persistent cross-career profile that tracks cumulative achievements
 * and unlocks for New Game+ mode. Stored in localStorage, not in
 * individual game saves.
 */
export interface LegacyProfile {
  /** Unique profile identifier. */
  id: string;
  /** All completed careers, newest first. */
  completedCareers: CompletedCareer[];
  /** Scenario IDs unlocked for future playthroughs. */
  unlockedScenarios: string[];
  /** All legacy perks earned across careers. */
  legacyPerks: LegacyPerk[];
  /** Cumulative discoveries across all completed careers. */
  totalDiscoveries: number;
  /** Cumulative seasons played across all completed careers. */
  totalSeasonsPlayed: number;
  /** Best hit rate achieved in any single career (0-1). */
  bestHitRate: number;
  /** Highest legacy score achieved in any single career. */
  bestLegacyScore: number;
  /** Highest career tier reached across all careers. */
  highestTierReached: number;
}

// =============================================================================
// CONTACT NETWORK DEPTH (F3)
// =============================================================================

/**
 * A record of an interaction between the scout and a contact.
 * Stored in Contact.interactionHistory for trust/loyalty calculations.
 */
export interface ContactInteraction {
  week: number;
  type: "meeting" | "tip" | "referral" | "betrayal" | "favor";
  trustDelta: number;
}

/**
 * A piece of gossip shared by a contact. Gossip items have a limited
 * lifespan and varying reliability based on the contact's loyalty.
 */
export interface GossipItem {
  id: string;
  type: "transferRumor" | "unhappyPlayer" | "youthProspect" | "managerChange" | "injuryNews";
  playerId?: string;
  clubId?: string;
  /** 0-1: how reliable this gossip is (contact loyalty affects this). */
  reliability: number;
  /** The week this gossip was revealed to the scout. */
  revealedWeek: number;
  /** The week after which this gossip becomes stale. */
  expiresWeek: number;
  /** Human-readable gossip content. */
  content: string;
}

// =============================================================================
// MATCH TACTICAL LAYER (F5)
// =============================================================================

/**
 * The result of comparing two clubs' tactical styles for a single match.
 * Modifiers affect event quality and event frequency distribution.
 */
export interface TacticalMatchup {
  homeStyle: TacticalIdentity;
  awayStyle: TacticalIdentity;
  /** Quality modifier applied to home team events, range [-0.3, +0.3]. */
  homeModifier: number;
  /** Quality modifier applied to away team events, range [-0.3, +0.3]. */
  awayModifier: number;
  /** Event frequency adjustments derived from the matchup interaction. */
  eventShift: Partial<Record<MatchEventType, number>>;
}

/**
 * A substitution event generated during match simulation.
 * Tracks tactical, injury, fatigue, and disciplinary subs.
 */
export interface MatchSubstitution {
  minute: number;
  playerOutId: string;
  playerInId: string;
  tacticalReason: "injury" | "tactical" | "fatigue" | "redCard";
}

// =============================================================================
// DYNAMIC BOARD EXPECTATIONS (F10)
// =============================================================================

/**
 * Board personality archetype. Each personality shifts the satisfaction
 * thresholds, patience decay, and reaction severity.
 *
 * - patient:        Wide neutral band, slow patience decay
 * - impatient:      Narrow neutral band, fast patience decay
 * - penny-pinching: Budget-focused, budget cuts more severe
 * - ambitious:      Expects rapid growth, escalates directive difficulty
 * - hands-off:      Rarely intervenes, wide tolerance bands
 */
export type BoardPersonality =
  | "patient"
  | "impatient"
  | "penny-pinching"
  | "ambitious"
  | "hands-off";

/**
 * Profile of the club's board of directors. Tracks satisfaction,
 * patience, budget willingness, and ultimatum state.
 */
export interface BoardProfile {
  /** Board archetype — affects thresholds and reaction severity. */
  personality: BoardPersonality;
  /** Patience counter 0–100. Decreases when directives fail or scout underperforms. */
  patience: number;
  /** Overall satisfaction with the scouting department 0–100. */
  satisfactionLevel: number;
  /** Budget multiplier applied to directive allocations, range 0.5–2.0. */
  budgetMultiplier: number;
  /** Whether the board has issued a formal ultimatum. */
  ultimatumIssued: boolean;
  /** If ultimatum issued, the week deadline for improvement. */
  ultimatumDeadline?: number;
  /** History of directive type IDs issued (for escalation tracking). */
  recentDirectives: string[];
}

/**
 * A board reaction event triggered by satisfaction thresholds.
 */
export type BoardReactionType =
  | "praise"
  | "warning"
  | "budgetIncrease"
  | "budgetCut"
  | "ultimatum"
  | "demotion"
  | "firing";

export interface BoardReaction {
  /** The type of reaction. */
  type: BoardReactionType;
  /** Human-readable description of what triggered this reaction. */
  trigger: string;
  /** The week this reaction occurred. */
  week: number;
  /** Display message for the inbox / UI. */
  message: string;
}
